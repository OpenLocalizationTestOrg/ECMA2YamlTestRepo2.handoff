{"nodes":[{"pos":[464,556],"content":"Enables customization of managed objects that extend from unmanaged objects during creation.","needQuote":true,"needEscape":true,"nodes":[{"content":"Enables customization of managed objects that extend from unmanaged objects during creation.","pos":[0,92]}]},{"pos":[568,1616],"content":"The `ExtensibleClassFactory` allows users to specify a `delegate` that is called during construction of a runtime callable wrapper (RCW) that provides an instance of the underlying COM object. In effect, the callback acts as the class factory for the COM object wrapped by the RCW. Without the callback, the common language runtime creates the underlying COM object by calling `CoCreateInstance`. This callback provides an alternative way of activating the underlying object, such as with a COM moniker or by providing a singleton object. The <xref:System.Runtime.InteropServices.ExtensibleClassFactory.RegisterObjectCreationCallback%2A> method must be called in the `static` initializer of the class that is extending the RCW. Only one object creation callback is permitted per object type. When the extensible RCW is activated, the callback is registered. When the underlying COM object needs to be created, the callback is called to provide a reference to the object. The callback must return an `IUnknown` interface pointer for the base object.","needQuote":true,"needEscape":true,"extradata":"MT","nodes":[{"content":"The <ph id=\"ph1\">`ExtensibleClassFactory`</ph> allows users to specify a <ph id=\"ph2\">`delegate`</ph> that is called during construction of a runtime callable wrapper (RCW) that provides an instance of the underlying COM object.","pos":[0,192],"source":"The `ExtensibleClassFactory` allows users to specify a `delegate` that is called during construction of a runtime callable wrapper (RCW) that provides an instance of the underlying COM object."},{"content":"In effect, the callback acts as the class factory for the COM object wrapped by the RCW.","pos":[193,281]},{"content":"Without the callback, the common language runtime creates the underlying COM object by calling <ph id=\"ph1\">`CoCreateInstance`</ph>.","pos":[282,396],"source":" Without the callback, the common language runtime creates the underlying COM object by calling `CoCreateInstance`."},{"content":"This callback provides an alternative way of activating the underlying object, such as with a COM moniker or by providing a singleton object.","pos":[397,538]},{"content":"The &lt;xref:System.Runtime.InteropServices.ExtensibleClassFactory.RegisterObjectCreationCallback%2A&gt; method must be called in the <ph id=\"ph1\">`static`</ph> initializer of the class that is extending the RCW.","pos":[539,727],"source":" The <xref:System.Runtime.InteropServices.ExtensibleClassFactory.RegisterObjectCreationCallback%2A> method must be called in the `static` initializer of the class that is extending the RCW."},{"content":"Only one object creation callback is permitted per object type.","pos":[728,791]},{"content":"When the extensible RCW is activated, the callback is registered.","pos":[792,857]},{"content":"When the underlying COM object needs to be created, the callback is called to provide a reference to the object.","pos":[858,970]},{"content":"The callback must return an <ph id=\"ph1\">`IUnknown`</ph> interface pointer for the base object.","pos":[971,1048],"source":" The callback must return an `IUnknown` interface pointer for the base object."}]},{"pos":[3324,3543],"content":"Registers a <bpt id=\"p1\">&lt;xref uid=\"langword_csharp_delegate\" name=\"delegate\" href=\"\"&gt;</bpt><ept id=\"p1\">&lt;/xref&gt;</ept> that is called when an instance of a managed type, that extends from an unmanaged type, needs to allocate the aggregated unmanaged object.","needQuote":true,"needEscape":true,"source":"Registers a <xref uid=\"langword_csharp_delegate\" name=\"delegate\" href=\"\"></xref> that is called when an instance of a managed type, that extends from an unmanaged type, needs to allocate the aggregated unmanaged object."},{"pos":[3556,3863],"content":"This `delegate` allocates and aggregates the unmanaged object and is called in place of `CoCreateInstance`. This `delegate` must be registered in the context of the `static` class initializer for which the callbacks will be made.       Only one class in an hierarchy should register a `delegate` callback.","needQuote":false,"needEscape":true,"extradata":"MT","nodes":[{"content":"This <ph id=\"ph1\">`delegate`</ph> allocates and aggregates the unmanaged object and is called in place of <ph id=\"ph2\">`CoCreateInstance`</ph>.","pos":[0,107],"source":"This `delegate` allocates and aggregates the unmanaged object and is called in place of `CoCreateInstance`."},{"content":"This <ph id=\"ph1\">`delegate`</ph> must be registered in the context of the <ph id=\"ph2\">`static`</ph> class initializer for which the callbacks will be made.","pos":[108,229],"source":" This `delegate` must be registered in the context of the `static` class initializer for which the callbacks will be made."},{"content":"Only one class in an hierarchy should register a <ph id=\"ph1\">`delegate`</ph> callback.","pos":[236,305],"source":"       Only one class in an hierarchy should register a `delegate` callback."}]},{"pos":[4124,4307],"content":"A <bpt id=\"p1\">&lt;xref uid=\"langword_csharp_delegate\" name=\"delegate\" href=\"\"&gt;</bpt><ept id=\"p1\">&lt;/xref&gt;</ept> that is called in place of <bpt id=\"p2\">&lt;xref uid=\"langword_csharp_CoCreateInstance\" name=\"CoCreateInstance\" href=\"\"&gt;</bpt><ept id=\"p2\">&lt;/xref&gt;</ept>.","needQuote":true,"needEscape":true,"source":"A <xref uid=\"langword_csharp_delegate\" name=\"delegate\" href=\"\"></xref> that is called in place of <xref uid=\"langword_csharp_CoCreateInstance\" name=\"CoCreateInstance\" href=\"\"></xref>."}],"content":"### YamlMime:ManagedReference\nitems:\n- uid: System.Runtime.InteropServices.ExtensibleClassFactory\n  id: ExtensibleClassFactory\n  children:\n  - System.Runtime.InteropServices.ExtensibleClassFactory.RegisterObjectCreationCallback(System.Runtime.InteropServices.ObjectCreationDelegate)\n  langs:\n  - csharp\n  name: ExtensibleClassFactory\n  nameWithType: ExtensibleClassFactory\n  fullName: System.Runtime.InteropServices.ExtensibleClassFactory\n  type: Class\n  summary: Enables customization of managed objects that extend from unmanaged objects during creation.\n  remarks: The `ExtensibleClassFactory` allows users to specify a `delegate` that is called during construction of a runtime callable wrapper (RCW) that provides an instance of the underlying COM object. In effect, the callback acts as the class factory for the COM object wrapped by the RCW. Without the callback, the common language runtime creates the underlying COM object by calling `CoCreateInstance`. This callback provides an alternative way of activating the underlying object, such as with a COM moniker or by providing a singleton object. The <xref:System.Runtime.InteropServices.ExtensibleClassFactory.RegisterObjectCreationCallback%2A> method must be called in the `static` initializer of the class that is extending the RCW. Only one object creation callback is permitted per object type. When the extensible RCW is activated, the callback is registered. When the underlying COM object needs to be created, the callback is called to provide a reference to the object. The callback must return an `IUnknown` interface pointer for the base object.\n  example:\n  - \"Registers a `delegate` that will be called whenever an instance of a managed type that extends from an unmanaged type needs to allocate the aggregated unmanaged object. This `delegate` is expected to allocate and aggregate the unmanaged object and is called in place of a `CoCreateInstance`. This routine must be called in the context of the `static` initializer for the class for which the callbacks will be made.  \\n  \\n [!code-cs[Classic ExtensibleClassFactory Example#1](~/add/codesnippet/csharp/t-system.runtime.interop_2_1.cs)]\\n [!code-cpp[Classic ExtensibleClassFactory Example#1](~/add/codesnippet/cpp/t-system.runtime.interop_2_1.cpp)]\\n [!code-vb[Classic ExtensibleClassFactory Example#1](~/add/codesnippet/visualbasic/t-system.runtime.interop_2_1.vb)]\"\n  syntax:\n    content: >-\n      [System.Runtime.InteropServices.ComVisible(true)]\n\n      public sealed class ExtensibleClassFactory\n  inheritance:\n  - System.Object\n  implements: []\n  inheritedMembers: []\n  platform:\n  - net462\n- uid: System.Runtime.InteropServices.ExtensibleClassFactory.RegisterObjectCreationCallback(System.Runtime.InteropServices.ObjectCreationDelegate)\n  id: RegisterObjectCreationCallback(System.Runtime.InteropServices.ObjectCreationDelegate)\n  parent: System.Runtime.InteropServices.ExtensibleClassFactory\n  langs:\n  - csharp\n  name: RegisterObjectCreationCallback(ObjectCreationDelegate)\n  nameWithType: ExtensibleClassFactory.RegisterObjectCreationCallback(ObjectCreationDelegate)\n  fullName: System.Runtime.InteropServices.ExtensibleClassFactory.RegisterObjectCreationCallback(ObjectCreationDelegate)\n  type: Method\n  assemblies:\n  - mscorlib\n  namespace: System.Runtime.InteropServices\n  summary: Registers a <xref uid=\"langword_csharp_delegate\" name=\"delegate\" href=\"\"></xref> that is called when an instance of a managed type, that extends from an unmanaged type, needs to allocate the aggregated unmanaged object.\n  remarks: \"This `delegate` allocates and aggregates the unmanaged object and is called in place of `CoCreateInstance`. This `delegate` must be registered in the context of the `static` class initializer for which the callbacks will be made.  \\n  \\n Only one class in an hierarchy should register a `delegate` callback.\"\n  syntax:\n    content: public static void RegisterObjectCreationCallback (System.Runtime.InteropServices.ObjectCreationDelegate callback);\n    parameters:\n    - id: callback\n      type: System.Runtime.InteropServices.ObjectCreationDelegate\n      description: A <xref uid=\"langword_csharp_delegate\" name=\"delegate\" href=\"\"></xref> that is called in place of <xref uid=\"langword_csharp_CoCreateInstance\" name=\"CoCreateInstance\" href=\"\"></xref>.\n  overload: System.Runtime.InteropServices.ExtensibleClassFactory.RegisterObjectCreationCallback*\n  exceptions: []\n  platform:\n  - net462\nreferences:\n- uid: System.Object\n  isExternal: false\n  name: System.Object\n- uid: System.Runtime.InteropServices.ExtensibleClassFactory.RegisterObjectCreationCallback(System.Runtime.InteropServices.ObjectCreationDelegate)\n  parent: System.Runtime.InteropServices.ExtensibleClassFactory\n  isExternal: false\n  name: RegisterObjectCreationCallback(ObjectCreationDelegate)\n  nameWithType: ExtensibleClassFactory.RegisterObjectCreationCallback(ObjectCreationDelegate)\n  fullName: System.Runtime.InteropServices.ExtensibleClassFactory.RegisterObjectCreationCallback(ObjectCreationDelegate)\n- uid: System.Runtime.InteropServices.ObjectCreationDelegate\n  parent: System.Runtime.InteropServices\n  isExternal: false\n  name: ObjectCreationDelegate\n  nameWithType: ObjectCreationDelegate\n  fullName: System.Runtime.InteropServices.ObjectCreationDelegate\n- uid: System.Runtime.InteropServices.ExtensibleClassFactory.RegisterObjectCreationCallback*\n  parent: System.Runtime.InteropServices.ExtensibleClassFactory\n  isExternal: false\n  name: RegisterObjectCreationCallback\n  nameWithType: ExtensibleClassFactory.RegisterObjectCreationCallback\n"}