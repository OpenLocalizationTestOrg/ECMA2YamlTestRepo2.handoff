{"nodes":[{"pos":[660,795],"content":"Defines the methods that enable custom inspection or modification of inbound and outbound application messages in service applications.","needQuote":true,"needEscape":true,"nodes":[{"content":"Defines the methods that enable custom inspection or modification of inbound and outbound application messages in service applications.","pos":[0,135]}]},{"pos":[808,2530],"content":"Implement IDispatchMessageInspector to inspect or modify inbound or outbound application messages either prior to dispatching a request message to an operation or before returning a reply message to a caller. There are a large number of scenarios that require intercepting messages prior to invoking the operation for which it is destined. For example, you can log incoming application messages or perform some feature based on a message header.       Typically, message inspectors are inserted by a service behavior (<xref:System.ServiceModel.Description.IServiceBehavior?displayProperty=fullName>), an endpoint behavior (<xref:System.ServiceModel.Description.IEndpointBehavior?displayProperty=fullName>), or a contract behavior (<xref:System.ServiceModel.Description.IContractBehavior?displayProperty=fullName>). The behavior then adds the message inspector to the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageInspectors%2A?displayProperty=fullName> collection. For more information about extending the runtime using behaviors, see [Extending ServiceHost and the Service Model Layer](~/add/includes/ajax-current-ext-md.md).      -   The <xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.AfterReceiveRequest%2A> method enables custom behavior after receiving the message but before dispatching it to the intended operation.      -   The <xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.BeforeSendReply%2A> method enables custom behavior after the operation returns but before the reply is sent.      > [!NOTE] >  IDispatchMessageInspector objects are always called at the same point during message dispatch regardless of whether an operation is one-way or request-reply.","needQuote":false,"needEscape":true,"nodes":[{"content":"Implement IDispatchMessageInspector to inspect or modify inbound or outbound application messages either prior to dispatching a request message to an operation or before returning a reply message to a caller.","pos":[0,208]},{"content":"There are a large number of scenarios that require intercepting messages prior to invoking the operation for which it is destined.","pos":[209,339]},{"content":"For example, you can log incoming application messages or perform some feature based on a message header.","pos":[340,445]},{"content":"Typically, message inspectors are inserted by a service behavior (&lt;xref:System.ServiceModel.Description.IServiceBehavior?displayProperty=fullName&gt;), an endpoint behavior (&lt;xref:System.ServiceModel.Description.IEndpointBehavior?displayProperty=fullName&gt;), or a contract behavior (&lt;xref:System.ServiceModel.Description.IContractBehavior?displayProperty=fullName&gt;).","pos":[452,814],"source":"       Typically, message inspectors are inserted by a service behavior (<xref:System.ServiceModel.Description.IServiceBehavior?displayProperty=fullName>), an endpoint behavior (<xref:System.ServiceModel.Description.IEndpointBehavior?displayProperty=fullName>), or a contract behavior (<xref:System.ServiceModel.Description.IContractBehavior?displayProperty=fullName>)."},{"content":"The behavior then adds the message inspector to the &lt;xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageInspectors%2A?displayProperty=fullName&gt; collection.","pos":[815,978],"source":" The behavior then adds the message inspector to the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageInspectors%2A?displayProperty=fullName> collection."},{"content":"For more information about extending the runtime using behaviors, see <bpt id=\"p1\">[</bpt>Extending ServiceHost and the Service Model Layer<ept id=\"p1\">](~/add/includes/ajax-current-ext-md.md)</ept>.","pos":[979,1140],"source":" For more information about extending the runtime using behaviors, see [Extending ServiceHost and the Service Model Layer](~/add/includes/ajax-current-ext-md.md)."},{"content":"-   The &lt;xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.AfterReceiveRequest%2A&gt; method enables custom behavior after receiving the message but before dispatching it to the intended operation.","pos":[1146,1352],"source":"      -   The <xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.AfterReceiveRequest%2A> method enables custom behavior after receiving the message but before dispatching it to the intended operation."},{"content":"-   The &lt;xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.BeforeSendReply%2A&gt; method enables custom behavior after the operation returns but before the reply is sent.","pos":[1358,1537],"source":"      -   The <xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.BeforeSendReply%2A> method enables custom behavior after the operation returns but before the reply is sent."},{"content":"&gt; <ph id=\"ph1\">[!NOTE]</ph> &gt;  IDispatchMessageInspector objects are always called at the same point during message dispatch regardless of whether an operation is one-way or request-reply.","pos":[1543,1713],"source":"      > [!NOTE] >  IDispatchMessageInspector objects are always called at the same point during message dispatch regardless of whether an operation is one-way or request-reply."}]},{"pos":[4595,4708],"content":"Called after an inbound message has been received but before the message is dispatched to the intended operation.","needQuote":true,"needEscape":true,"nodes":[{"content":"Called after an inbound message has been received but before the message is dispatched to the intended operation.","pos":[0,113]}]},{"pos":[4721,5351],"content":"Use the AfterReceiveRequest method to inspect or modify the incoming message, the client channel that provided it, and the current service instance. The return value can be any object that you want to use for correlation purposes; it is returned to you as the `correlationState` parameter in the <xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.BeforeSendReply%2A> method.      > [!IMPORTANT] >  You cannot use the body of the message unless you buffer the entire message and make a copy. If you do this, you must make two copies of the message: one to inspect, and the other to overwrite the `request` parameter.","needQuote":false,"needEscape":true,"nodes":[{"content":"Use the AfterReceiveRequest method to inspect or modify the incoming message, the client channel that provided it, and the current service instance.","pos":[0,148]},{"content":"The return value can be any object that you want to use for correlation purposes; it is returned to you as the <ph id=\"ph1\">`correlationState`</ph> parameter in the &lt;xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.BeforeSendReply%2A&gt; method.","pos":[149,386],"source":" The return value can be any object that you want to use for correlation purposes; it is returned to you as the `correlationState` parameter in the <xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.BeforeSendReply%2A> method."},{"content":"&gt; <ph id=\"ph1\">[!IMPORTANT]</ph> &gt;  You cannot use the body of the message unless you buffer the entire message and make a copy.","pos":[392,502],"source":"      > [!IMPORTANT] >  You cannot use the body of the message unless you buffer the entire message and make a copy."},{"content":"If you do this, you must make two copies of the message: one to inspect, and the other to overwrite the <ph id=\"ph1\">`request`</ph> parameter.","pos":[503,627],"source":" If you do this, you must make two copies of the message: one to inspect, and the other to overwrite the `request` parameter."}]},{"pos":[6908,6928],"content":"The request message.","needQuote":true,"needEscape":true,"nodes":[{"content":"The request message.","pos":[0,20]}]},{"pos":[7013,7034],"content":"The incoming channel.","needQuote":true,"needEscape":true,"nodes":[{"content":"The incoming channel.","pos":[0,21]}]},{"pos":[7128,7157],"content":"The current service instance.","needQuote":true,"needEscape":true,"nodes":[{"content":"The current service instance.","pos":[0,29]}]},{"pos":[7215,7373],"content":"The object used to correlate state. This object is passed back in the <xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.BeforeSendReply*> method.","needQuote":true,"needEscape":true,"nodes":[{"content":"The object used to correlate state. This object is passed back in the <xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.BeforeSendReply*> method.","pos":[0,158],"nodes":[{"content":"The object used to correlate state.","pos":[0,35]},{"content":"This object is passed back in the &lt;xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.BeforeSendReply*&gt; method.","pos":[36,158],"source":" This object is passed back in the <xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.BeforeSendReply*> method."}]}]},{"pos":[8122,8199],"content":"Called after the operation has returned but before the reply message is sent.","needQuote":true,"needEscape":true,"nodes":[{"content":"Called after the operation has returned but before the reply message is sent.","pos":[0,77]}]},{"pos":[8211,8555],"content":"Use the BeforeSendReply method to perform custom behavior prior to sending the return message. The `correlationState` is the object returned from the <xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.AfterReceiveRequest%2A> method that you can use to perform correlation between inbound and outbound calls to support your behavior.","needQuote":true,"needEscape":true,"nodes":[{"content":"Use the BeforeSendReply method to perform custom behavior prior to sending the return message.","pos":[0,94]},{"content":"The <ph id=\"ph1\">`correlationState`</ph> is the object returned from the &lt;xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.AfterReceiveRequest%2A&gt; method that you can use to perform correlation between inbound and outbound calls to support your behavior.","pos":[95,344],"source":" The `correlationState` is the object returned from the <xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.AfterReceiveRequest%2A> method that you can use to perform correlation between inbound and outbound calls to support your behavior."}]},{"pos":[10029,10095],"content":"The reply message. This value is null if the operation is one way.","needQuote":true,"needEscape":true,"nodes":[{"content":"The reply message. This value is null if the operation is one way.","pos":[0,66],"nodes":[{"content":"The reply message.","pos":[0,18]},{"content":"This value is null if the operation is one way.","pos":[19,66]}]}]},{"pos":[10168,10301],"content":"The correlation object returned from the <xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.AfterReceiveRequest*> method.","needQuote":true,"needEscape":true,"nodes":[{"content":"The correlation object returned from the &lt;xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.AfterReceiveRequest*&gt; method.","pos":[0,133],"source":"The correlation object returned from the <xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.AfterReceiveRequest*> method."}]}],"content":"### YamlMime:ManagedReference\nitems:\n- uid: System.ServiceModel.Dispatcher.IDispatchMessageInspector\n  id: IDispatchMessageInspector\n  children:\n  - System.ServiceModel.Dispatcher.IDispatchMessageInspector.AfterReceiveRequest(System.ServiceModel.Channels.Message@,System.ServiceModel.IClientChannel,System.ServiceModel.InstanceContext)\n  - System.ServiceModel.Dispatcher.IDispatchMessageInspector.BeforeSendReply(System.ServiceModel.Channels.Message@,System.Object)\n  langs:\n  - csharp\n  name: IDispatchMessageInspector\n  nameWithType: IDispatchMessageInspector\n  fullName: System.ServiceModel.Dispatcher.IDispatchMessageInspector\n  type: Interface\n  summary: Defines the methods that enable custom inspection or modification of inbound and outbound application messages in service applications.\n  remarks: \"Implement IDispatchMessageInspector to inspect or modify inbound or outbound application messages either prior to dispatching a request message to an operation or before returning a reply message to a caller. There are a large number of scenarios that require intercepting messages prior to invoking the operation for which it is destined. For example, you can log incoming application messages or perform some feature based on a message header.  \\n  \\n Typically, message inspectors are inserted by a service behavior (<xref:System.ServiceModel.Description.IServiceBehavior?displayProperty=fullName>), an endpoint behavior (<xref:System.ServiceModel.Description.IEndpointBehavior?displayProperty=fullName>), or a contract behavior (<xref:System.ServiceModel.Description.IContractBehavior?displayProperty=fullName>). The behavior then adds the message inspector to the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageInspectors%2A?displayProperty=fullName> collection. For more information about extending the runtime using behaviors, see [Extending ServiceHost and the Service Model Layer](~/add/includes/ajax-current-ext-md.md).  \\n  \\n-   The <xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.AfterReceiveRequest%2A> method enables custom behavior after receiving the message but before dispatching it to the intended operation.  \\n  \\n-   The <xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.BeforeSendReply%2A> method enables custom behavior after the operation returns but before the reply is sent.  \\n  \\n> [!NOTE]\\n>  IDispatchMessageInspector objects are always called at the same point during message dispatch regardless of whether an operation is one-way or request-reply.\"\n  example:\n  - \"The following code example shows a basic IDispatchMessageInspector that writes a string to the console when it is invoked.  \\n  \\n [!code-vb[Interceptors#7](~/add/codesnippet/visualbasic/interceptors.client/interceptors.vb#7)]\\n [!code-cs[Interceptors#7](~/add/codesnippet/csharp/interceptors.client/interceptors.cs#7)]  \\n  \\n The following code example shows the implementation of an <xref:System.ServiceModel.Description.IServiceBehavior> that adds the `Inspector`IDispatchMessageInspector to the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageInspectors%2A?displayProperty=fullName> collection.  \\n  \\n [!code-vb[Interceptors#8](~/add/codesnippet/visualbasic/interceptors.client/insertingbehaviors.vb#8)]\\n [!code-cs[Interceptors#8](~/add/codesnippet/csharp/interceptors.client/insertingbehaviors.cs#8)]  \\n  \\n The following code example shows the use of an application configuration file to load the service behavior that inserts the `Inspector`IDispatchMessageInspector.  \\n  \\n [!code-cs[XpsCreate#XpsCreateAddPkgContent](~/add/codesnippet/csharp/XpsCreate/XpsCreate.cs#xpscreateaddpkgcontent)]\"\n  syntax:\n    content: public interface IDispatchMessageInspector\n  implements: []\n  platform:\n  - net462\n- uid: System.ServiceModel.Dispatcher.IDispatchMessageInspector.AfterReceiveRequest(System.ServiceModel.Channels.Message@,System.ServiceModel.IClientChannel,System.ServiceModel.InstanceContext)\n  id: AfterReceiveRequest(System.ServiceModel.Channels.Message@,System.ServiceModel.IClientChannel,System.ServiceModel.InstanceContext)\n  parent: System.ServiceModel.Dispatcher.IDispatchMessageInspector\n  langs:\n  - csharp\n  name: AfterReceiveRequest(Message,IClientChannel,InstanceContext)\n  nameWithType: IDispatchMessageInspector.AfterReceiveRequest(Message,IClientChannel,InstanceContext)\n  fullName: System.ServiceModel.Dispatcher.IDispatchMessageInspector.AfterReceiveRequest(Message,IClientChannel,InstanceContext)\n  type: Method\n  assemblies:\n  - System.ServiceModel\n  namespace: System.ServiceModel.Dispatcher\n  summary: Called after an inbound message has been received but before the message is dispatched to the intended operation.\n  remarks: \"Use the AfterReceiveRequest method to inspect or modify the incoming message, the client channel that provided it, and the current service instance. The return value can be any object that you want to use for correlation purposes; it is returned to you as the `correlationState` parameter in the <xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.BeforeSendReply%2A> method.  \\n  \\n> [!IMPORTANT]\\n>  You cannot use the body of the message unless you buffer the entire message and make a copy. If you do this, you must make two copies of the message: one to inspect, and the other to overwrite the `request` parameter.\"\n  example:\n  - \"The following code example shows a basic <xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector> that writes a string to the console when it is invoked.  \\n  \\n [!code-vb[Interceptors#7](~/add/codesnippet/visualbasic/interceptors.client/interceptors.vb#7)]\\n [!code-cs[Interceptors#7](~/add/codesnippet/csharp/interceptors.client/interceptors.cs#7)]  \\n  \\n The following code example shows the implementation of an <xref:System.ServiceModel.Description.IServiceBehavior> that adds the `Inspector`<xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector> to the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageInspectors%2A?displayProperty=fullName> collection.  \\n  \\n [!code-vb[Interceptors#8](~/add/codesnippet/visualbasic/interceptors.client/insertingbehaviors.vb#8)]\\n [!code-cs[Interceptors#8](~/add/codesnippet/csharp/interceptors.client/insertingbehaviors.cs#8)]  \\n  \\n The following code example shows the use of an application configuration file to load the service behavior that inserts the `Inspector`<xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector>.  \\n  \\n [!code-cs[XpsCreate#XpsCreateAddPkgContent](~/add/codesnippet/csharp/XpsCreate/XpsCreate.cs#xpscreateaddpkgcontent)]\"\n  syntax:\n    content: public object AfterReceiveRequest (ref System.ServiceModel.Channels.Message request, System.ServiceModel.IClientChannel channel, System.ServiceModel.InstanceContext instanceContext);\n    parameters:\n    - id: request\n      type: System.ServiceModel.Channels.Message\n      description: The request message.\n    - id: channel\n      type: System.ServiceModel.IClientChannel\n      description: The incoming channel.\n    - id: instanceContext\n      type: System.ServiceModel.InstanceContext\n      description: The current service instance.\n    return:\n      type: System.Object\n      description: The object used to correlate state. This object is passed back in the <xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.BeforeSendReply*> method.\n  overload: System.ServiceModel.Dispatcher.IDispatchMessageInspector.AfterReceiveRequest*\n  exceptions: []\n  platform:\n  - net462\n- uid: System.ServiceModel.Dispatcher.IDispatchMessageInspector.BeforeSendReply(System.ServiceModel.Channels.Message@,System.Object)\n  id: BeforeSendReply(System.ServiceModel.Channels.Message@,System.Object)\n  parent: System.ServiceModel.Dispatcher.IDispatchMessageInspector\n  langs:\n  - csharp\n  name: BeforeSendReply(Message,Object)\n  nameWithType: IDispatchMessageInspector.BeforeSendReply(Message,Object)\n  fullName: System.ServiceModel.Dispatcher.IDispatchMessageInspector.BeforeSendReply(Message,Object)\n  type: Method\n  assemblies:\n  - System.ServiceModel\n  namespace: System.ServiceModel.Dispatcher\n  summary: Called after the operation has returned but before the reply message is sent.\n  remarks: Use the BeforeSendReply method to perform custom behavior prior to sending the return message. The `correlationState` is the object returned from the <xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.AfterReceiveRequest%2A> method that you can use to perform correlation between inbound and outbound calls to support your behavior.\n  example:\n  - \"The following code example shows a basic <xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector> that writes a string to the console when it is invoked.  \\n  \\n [!code-vb[Interceptors#7](~/add/codesnippet/visualbasic/interceptors.client/interceptors.vb#7)]\\n [!code-cs[Interceptors#7](~/add/codesnippet/csharp/interceptors.client/interceptors.cs#7)]  \\n  \\n The following code example shows the implementation of an <xref:System.ServiceModel.Description.IServiceBehavior> that adds the `Inspector`<xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector> to the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageInspectors%2A?displayProperty=fullName> collection.  \\n  \\n [!code-vb[Interceptors#8](~/add/codesnippet/visualbasic/interceptors.client/insertingbehaviors.vb#8)]\\n [!code-cs[Interceptors#8](~/add/codesnippet/csharp/interceptors.client/insertingbehaviors.cs#8)]  \\n  \\n The following code example shows the use of an application configuration file to load the service behavior that inserts the `Inspector`<xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector>.  \\n  \\n [!code-cs[XpsCreate#XpsCreateAddPkgContent](~/add/codesnippet/csharp/XpsCreate/XpsCreate.cs#xpscreateaddpkgcontent)]\"\n  syntax:\n    content: public void BeforeSendReply (ref System.ServiceModel.Channels.Message reply, object correlationState);\n    parameters:\n    - id: reply\n      type: System.ServiceModel.Channels.Message\n      description: The reply message. This value is null if the operation is one way.\n    - id: correlationState\n      type: System.Object\n      description: The correlation object returned from the <xref:System.ServiceModel.Dispatcher.IDispatchMessageInspector.AfterReceiveRequest*> method.\n  overload: System.ServiceModel.Dispatcher.IDispatchMessageInspector.BeforeSendReply*\n  exceptions: []\n  platform:\n  - net462\nreferences:\n- uid: System.ServiceModel.Dispatcher.IDispatchMessageInspector.AfterReceiveRequest(System.ServiceModel.Channels.Message@,System.ServiceModel.IClientChannel,System.ServiceModel.InstanceContext)\n  parent: System.ServiceModel.Dispatcher.IDispatchMessageInspector\n  isExternal: false\n  name: AfterReceiveRequest(Message,IClientChannel,InstanceContext)\n  nameWithType: IDispatchMessageInspector.AfterReceiveRequest(Message,IClientChannel,InstanceContext)\n  fullName: System.ServiceModel.Dispatcher.IDispatchMessageInspector.AfterReceiveRequest(Message,IClientChannel,InstanceContext)\n- uid: System.Object\n  parent: System\n  isExternal: true\n  name: Object\n  nameWithType: Object\n  fullName: System.Object\n- uid: System.ServiceModel.Channels.Message\n  parent: System.ServiceModel.Channels\n  isExternal: true\n  name: Message\n  nameWithType: Message\n  fullName: System.ServiceModel.Channels.Message\n- uid: System.ServiceModel.IClientChannel\n  parent: System.ServiceModel\n  isExternal: true\n  name: IClientChannel\n  nameWithType: IClientChannel\n  fullName: System.ServiceModel.IClientChannel\n- uid: System.ServiceModel.InstanceContext\n  parent: System.ServiceModel\n  isExternal: true\n  name: InstanceContext\n  nameWithType: InstanceContext\n  fullName: System.ServiceModel.InstanceContext\n- uid: System.ServiceModel.Dispatcher.IDispatchMessageInspector.BeforeSendReply(System.ServiceModel.Channels.Message@,System.Object)\n  parent: System.ServiceModel.Dispatcher.IDispatchMessageInspector\n  isExternal: false\n  name: BeforeSendReply(Message,Object)\n  nameWithType: IDispatchMessageInspector.BeforeSendReply(Message,Object)\n  fullName: System.ServiceModel.Dispatcher.IDispatchMessageInspector.BeforeSendReply(Message,Object)\n- uid: System.ServiceModel.Dispatcher.IDispatchMessageInspector.AfterReceiveRequest*\n  parent: System.ServiceModel.Dispatcher.IDispatchMessageInspector\n  isExternal: false\n  name: AfterReceiveRequest\n  nameWithType: IDispatchMessageInspector.AfterReceiveRequest\n- uid: System.ServiceModel.Dispatcher.IDispatchMessageInspector.BeforeSendReply*\n  parent: System.ServiceModel.Dispatcher.IDispatchMessageInspector\n  isExternal: false\n  name: BeforeSendReply\n  nameWithType: IDispatchMessageInspector.BeforeSendReply\n"}