{"nodes":[{"pos":[668,844],"content":"Describes an interface that a resource manager should implement to provide two phase commit notification callbacks for the transaction manager upon enlisting for participation.","needQuote":true,"needEscape":true,"nodes":[{"content":"Describes an interface that a resource manager should implement to provide two phase commit notification callbacks for the transaction manager upon enlisting for participation.","pos":[0,176]}]},{"pos":[857,3348],"content":"In order for a resource manager to participate in a transaction, it must enlist in the transaction through the transaction manager. The <xref:System.Transactions.Transaction> class defines a set of methods whose names begin with `Enlist` that provide this functionality. The different `Enlist` methods correspond to the different types of enlistment that a resource maanger may have.       This class describes an interface that a resource manager should implement to provide two phase commit notification callbacks for the transaction manager upon enlisting for participation. For each resource manager's implementation of the IEnlistmentNotification interface, you should enlist it using the <xref:System.Transactions.Transaction.EnlistVolatile%2A> method or the <xref:System.Transactions.Transaction.EnlistDurable%2A> method of the <xref:System.Transactions.Transaction> class, depending on whether your resource is volatile or durable. For more information on enlistment and 2PC, see [Enlisting Resources as Participants in a Transaction](~/add/includes/ajax-current-ext-md.md) and [Committing a Transaction in Single-Phase and Multi-Phase](~/add/includes/ajax-current-ext-md.md) respectively.       The transaction manager notifies the enlisted object at different phases of the Two Phase Commit Protocol by the following methods.      |Method|Description|   |------------|-----------------|   |<xref:System.Transactions.IEnlistmentNotification.Prepare%2A>|This method of an enlisted object is used as a callback by the Transaction Manager during the first phase of a transaction, when the transaction manager asks participants whether they can commit the transaction.|   |<xref:System.Transactions.IEnlistmentNotification.Commit%2A>|This method of an enlisted object is used as a callback by the Transaction Manager during the second phase of a transaction if the transaction is commited.|   |<xref:System.Transactions.IEnlistmentNotification.Rollback%2A>|This method of an enlisted object is used as a callback by the Transaction Manager during the second phase of a transaction if the transaction is aborted (that is, rolled back).|   |<xref:System.Transactions.IEnlistmentNotification.InDoubt%2A>|This method of an enlisted object is used as a callback by the Transaction Manager during the second phase of a transaction if the transaction is in doubt.|      > [!NOTE] >  You should be aware that notifications might not be sent sequentially, or in a particular order.","needQuote":false,"needEscape":true,"extradata":"MT","nodes":[{"content":"In order for a resource manager to participate in a transaction, it must enlist in the transaction through the transaction manager.","pos":[0,131]},{"content":"The &lt;xref:System.Transactions.Transaction&gt; class defines a set of methods whose names begin with <ph id=\"ph1\">`Enlist`</ph> that provide this functionality.","pos":[132,270],"source":" The <xref:System.Transactions.Transaction> class defines a set of methods whose names begin with `Enlist` that provide this functionality."},{"content":"The different <ph id=\"ph1\">`Enlist`</ph> methods correspond to the different types of enlistment that a resource maanger may have.","pos":[271,383],"source":" The different `Enlist` methods correspond to the different types of enlistment that a resource maanger may have."},{"content":"This class describes an interface that a resource manager should implement to provide two phase commit notification callbacks for the transaction manager upon enlisting for participation.","pos":[390,577]},{"content":"For each resource manager's implementation of the IEnlistmentNotification interface, you should enlist it using the &lt;xref:System.Transactions.Transaction.EnlistVolatile%2A&gt; method or the &lt;xref:System.Transactions.Transaction.EnlistDurable%2A&gt; method of the &lt;xref:System.Transactions.Transaction&gt; class, depending on whether your resource is volatile or durable.","pos":[578,939],"source":" For each resource manager's implementation of the IEnlistmentNotification interface, you should enlist it using the <xref:System.Transactions.Transaction.EnlistVolatile%2A> method or the <xref:System.Transactions.Transaction.EnlistDurable%2A> method of the <xref:System.Transactions.Transaction> class, depending on whether your resource is volatile or durable."},{"content":"For more information on enlistment and 2PC, see <bpt id=\"p1\">[</bpt>Enlisting Resources as Participants in a Transaction<ept id=\"p1\">](~/add/includes/ajax-current-ext-md.md)</ept> and <bpt id=\"p2\">[</bpt>Committing a Transaction in Single-Phase and Multi-Phase<ept id=\"p2\">](~/add/includes/ajax-current-ext-md.md)</ept> respectively.","pos":[940,1197],"source":" For more information on enlistment and 2PC, see [Enlisting Resources as Participants in a Transaction](~/add/includes/ajax-current-ext-md.md) and [Committing a Transaction in Single-Phase and Multi-Phase](~/add/includes/ajax-current-ext-md.md) respectively."},{"content":"The transaction manager notifies the enlisted object at different phases of the Two Phase Commit Protocol by the following methods.","pos":[1204,1335]},{"content":"|Method|Description|   |------------|-----------------|   |&lt;xref:System.Transactions.IEnlistmentNotification.Prepare%2A&gt;|This method of an enlisted object is used as a callback by the Transaction Manager during the first phase of a transaction, when the transaction manager asks participants whether they can commit the transaction.|   |&lt;xref:System.Transactions.IEnlistmentNotification.Commit%2A&gt;|This method of an enlisted object is used as a callback by the Transaction Manager during the second phase of a transaction if the transaction is commited.|   |&lt;xref:System.Transactions.IEnlistmentNotification.Rollback%2A&gt;|This method of an enlisted object is used as a callback by the Transaction Manager during the second phase of a transaction if the transaction is aborted (that is, rolled back).|   |&lt;xref:System.Transactions.IEnlistmentNotification.InDoubt%2A&gt;|This method of an enlisted object is used as a callback by the Transaction Manager during the second phase of a transaction if the transaction is in doubt.|      &gt; <ph id=\"ph1\">[!NOTE]</ph> &gt;  You should be aware that notifications might not be sent sequentially, or in a particular order.","pos":[1341,2477],"source":"      |Method|Description|   |------------|-----------------|   |<xref:System.Transactions.IEnlistmentNotification.Prepare%2A>|This method of an enlisted object is used as a callback by the Transaction Manager during the first phase of a transaction, when the transaction manager asks participants whether they can commit the transaction.|   |<xref:System.Transactions.IEnlistmentNotification.Commit%2A>|This method of an enlisted object is used as a callback by the Transaction Manager during the second phase of a transaction if the transaction is commited.|   |<xref:System.Transactions.IEnlistmentNotification.Rollback%2A>|This method of an enlisted object is used as a callback by the Transaction Manager during the second phase of a transaction if the transaction is aborted (that is, rolled back).|   |<xref:System.Transactions.IEnlistmentNotification.InDoubt%2A>|This method of an enlisted object is used as a callback by the Transaction Manager during the second phase of a transaction if the transaction is in doubt.|      > [!NOTE] >  You should be aware that notifications might not be sent sequentially, or in a particular order."}]},{"pos":[4319,4385],"content":"Notifies an enlisted object that a transaction is being committed.","needQuote":true,"needEscape":true,"nodes":[{"content":"Notifies an enlisted object that a transaction is being committed.","pos":[0,66]}]},{"pos":[4398,5811],"content":"The transaction manager calls this method of an enlisted object during the second phase of a commitment, when it instructs all participants to commit the transaction.       The resource manager should perform any work necessary to finish the transaction and then inform the TM that it has finished by calling the <xref:System.Transactions.Enlistment.Done%2A> method on the `enlistment` parameter.       If the resource manager has enlisted durably, but does not respond by calling <xref:System.Transactions.Enlistment.Done%2A> method, the transaction manager is unsure that the resource manager has received the Commit call. As such, the transaction manager keeps waiting for a response, and maintains information relevant to this transaction.  If <xref:System.Transactions.Enlistment.Done%2A> is never called, this piece of information is kept around indefinitely in memory or in a system-wide resource. This results in resources not being able to be reclaimed. In the case of a distributed transaction, this could eventually fill the MSDTC log which halts the MSDTC process. In the case of a transaction managed by <xref:System.Transactions>, this results in a gradual and continual increase in the memory consumption of the resource manager's process. Therefore, it is crucial that you call the <xref:System.Transactions.Enlistment.Done%2A> method once your resource manager is done with your prepare work.","needQuote":false,"needEscape":true,"extradata":"MT","nodes":[{"content":"The transaction manager calls this method of an enlisted object during the second phase of a commitment, when it instructs all participants to commit the transaction.","pos":[0,166]},{"content":"The resource manager should perform any work necessary to finish the transaction and then inform the TM that it has finished by calling the &lt;xref:System.Transactions.Enlistment.Done%2A&gt; method on the <ph id=\"ph1\">`enlistment`</ph> parameter.","pos":[173,396],"source":"       The resource manager should perform any work necessary to finish the transaction and then inform the TM that it has finished by calling the <xref:System.Transactions.Enlistment.Done%2A> method on the `enlistment` parameter."},{"content":"If the resource manager has enlisted durably, but does not respond by calling &lt;xref:System.Transactions.Enlistment.Done%2A&gt; method, the transaction manager is unsure that the resource manager has received the Commit call.","pos":[403,624],"source":"       If the resource manager has enlisted durably, but does not respond by calling <xref:System.Transactions.Enlistment.Done%2A> method, the transaction manager is unsure that the resource manager has received the Commit call."},{"content":"As such, the transaction manager keeps waiting for a response, and maintains information relevant to this transaction.","pos":[625,743]},{"content":"If &lt;xref:System.Transactions.Enlistment.Done%2A&gt; is never called, this piece of information is kept around indefinitely in memory or in a system-wide resource.","pos":[745,904],"source":"  If <xref:System.Transactions.Enlistment.Done%2A> is never called, this piece of information is kept around indefinitely in memory or in a system-wide resource."},{"content":"This results in resources not being able to be reclaimed.","pos":[905,962]},{"content":"In the case of a distributed transaction, this could eventually fill the MSDTC log which halts the MSDTC process.","pos":[963,1076]},{"content":"In the case of a transaction managed by &lt;xref:System.Transactions&gt;, this results in a gradual and continual increase in the memory consumption of the resource manager's process.","pos":[1077,1254],"source":" In the case of a transaction managed by <xref:System.Transactions>, this results in a gradual and continual increase in the memory consumption of the resource manager's process."},{"content":"Therefore, it is crucial that you call the &lt;xref:System.Transactions.Enlistment.Done%2A&gt; method once your resource manager is done with your prepare work.","pos":[1255,1409],"source":" Therefore, it is crucial that you call the <xref:System.Transactions.Enlistment.Done%2A> method once your resource manager is done with your prepare work."}]},{"pos":[5999,6112],"content":"An <bpt id=\"p1\">&lt;xref href=\"System.Transactions.Enlistment\"&gt;</bpt><ept id=\"p1\">&lt;/xref&gt;</ept> object used to send a response to the transaction manager.","needQuote":true,"needEscape":true,"source":"An <xref href=\"System.Transactions.Enlistment\"></xref> object used to send a response to the transaction manager."},{"pos":[6689,6762],"content":"Notifies an enlisted object that the status of a transaction is in doubt.","needQuote":true,"needEscape":true,"nodes":[{"content":"Notifies an enlisted object that the status of a transaction is in doubt.","pos":[0,73]}]},{"pos":[6775,8663],"content":"This method is called for volatile resources when the transaction manager has invoked a single phase commit operation to a single durable resource, and then connection to the durable resource was lost prior to getting the transaction result. At that point, the transaction outcome cannot be safely determined.       As InDoubt is considered to be a final state for a transaction, you should not call <xref:System.Transactions.IEnlistmentNotification.Commit%2A> or <xref:System.Transactions.IEnlistmentNotification.Rollback%2A> after calling InDoubt.      > [!NOTE] >  Your implementation of this method for the volatile resource should perform whatever recovery or containment operation it understands on the affected data.  It must also call the <xref:System.Transactions.Enlistment.Done%2A> method on the on the `enlistment` parameter when it has finished its work.       If the resource manager has enlisted durably, but does not respond by calling <xref:System.Transactions.Enlistment.Done%2A> method, the transaction manager is unsure that the resource manager has received the InDoubt call. As such, the transaction manager keeps waiting for a response, and maintains information relevant to this transaction.  If <xref:System.Transactions.Enlistment.Done%2A> is never called, this piece of information is kept around indefinitely in memory or in a system-wide resource. This results in resources not being able to be reclaimed. In the case of a distributed transaction, this could eventually fill the MSDTC log which halts the MSDTC process. In the case of a transaction managed by <xref:System.Transactions>, this results in a gradual and continual increase in the memory consumption of the resource manager's process. Therefore, it is crucial that you call the <xref:System.Transactions.Enlistment.Done%2A> method once your resource manager is done with your prepare work.","needQuote":false,"needEscape":true,"extradata":"MT","nodes":[{"content":"This method is called for volatile resources when the transaction manager has invoked a single phase commit operation to a single durable resource, and then connection to the durable resource was lost prior to getting the transaction result.","pos":[0,241]},{"content":"At that point, the transaction outcome cannot be safely determined.","pos":[242,309]},{"content":"As InDoubt is considered to be a final state for a transaction, you should not call &lt;xref:System.Transactions.IEnlistmentNotification.Commit%2A&gt; or &lt;xref:System.Transactions.IEnlistmentNotification.Rollback%2A&gt; after calling InDoubt.","pos":[316,549],"source":"       As InDoubt is considered to be a final state for a transaction, you should not call <xref:System.Transactions.IEnlistmentNotification.Commit%2A> or <xref:System.Transactions.IEnlistmentNotification.Rollback%2A> after calling InDoubt."},{"content":"&gt; <ph id=\"ph1\">[!NOTE]</ph> &gt;  Your implementation of this method for the volatile resource should perform whatever recovery or containment operation it understands on the affected data.","pos":[555,723],"source":"      > [!NOTE] >  Your implementation of this method for the volatile resource should perform whatever recovery or containment operation it understands on the affected data."},{"content":"It must also call the &lt;xref:System.Transactions.Enlistment.Done%2A&gt; method on the on the <ph id=\"ph1\">`enlistment`</ph> parameter when it has finished its work.","pos":[725,867],"source":"  It must also call the <xref:System.Transactions.Enlistment.Done%2A> method on the on the `enlistment` parameter when it has finished its work."},{"content":"If the resource manager has enlisted durably, but does not respond by calling &lt;xref:System.Transactions.Enlistment.Done%2A&gt; method, the transaction manager is unsure that the resource manager has received the InDoubt call.","pos":[874,1096],"source":"       If the resource manager has enlisted durably, but does not respond by calling <xref:System.Transactions.Enlistment.Done%2A> method, the transaction manager is unsure that the resource manager has received the InDoubt call."},{"content":"As such, the transaction manager keeps waiting for a response, and maintains information relevant to this transaction.","pos":[1097,1215]},{"content":"If &lt;xref:System.Transactions.Enlistment.Done%2A&gt; is never called, this piece of information is kept around indefinitely in memory or in a system-wide resource.","pos":[1217,1376],"source":"  If <xref:System.Transactions.Enlistment.Done%2A> is never called, this piece of information is kept around indefinitely in memory or in a system-wide resource."},{"content":"This results in resources not being able to be reclaimed.","pos":[1377,1434]},{"content":"In the case of a distributed transaction, this could eventually fill the MSDTC log which halts the MSDTC process.","pos":[1435,1548]},{"content":"In the case of a transaction managed by &lt;xref:System.Transactions&gt;, this results in a gradual and continual increase in the memory consumption of the resource manager's process.","pos":[1549,1726],"source":" In the case of a transaction managed by <xref:System.Transactions>, this results in a gradual and continual increase in the memory consumption of the resource manager's process."},{"content":"Therefore, it is crucial that you call the &lt;xref:System.Transactions.Enlistment.Done%2A&gt; method once your resource manager is done with your prepare work.","pos":[1727,1881],"source":" Therefore, it is crucial that you call the <xref:System.Transactions.Enlistment.Done%2A> method once your resource manager is done with your prepare work."}]},{"pos":[8852,8965],"content":"An <bpt id=\"p1\">&lt;xref href=\"System.Transactions.Enlistment\"&gt;</bpt><ept id=\"p1\">&lt;/xref&gt;</ept> object used to send a response to the transaction manager.","needQuote":true,"needEscape":true,"source":"An <xref href=\"System.Transactions.Enlistment\"></xref> object used to send a response to the transaction manager."},{"pos":[9588,9668],"content":"Notifies an enlisted object that a transaction is being prepared for commitment.","needQuote":true,"needEscape":true,"nodes":[{"content":"Notifies an enlisted object that a transaction is being prepared for commitment.","pos":[0,80]}]},{"pos":[9681,11656],"content":"The transaction manager calls this method of an enlisted resource manager during the phase 1 of a commitment, when it asks participants whether they can commit the transaction.       When you are implementing a durable resource manager, you should log your prepare record during this phase. The record should contain all the necessary information to perform recovery. This includes the <xref:System.Transactions.PreparingEnlistment.RecoveryInformation%2A> property, which is passed to the transaction manager in the <xref:System.Transactions.TransactionManager.Reenlist%2A> method during recovery. For more information on recovery, see [Performing Recovery](http://msdn.microsoft.com/en-us/d342c5c7-da64-4a4c-8e63-b52f4fbf2691).       Your resource manager should complete all work that must be finished before calling the <xref:System.Transactions.PreparingEnlistment.Prepared%2A> method of the `preparingEnlistment` parameter to indicate its vote for commitment. You should make sure that this is accomplished before receiving any phase 2 notification such as commit, rollback or in doubt. This is because phase 2 notifications can happen inline on the same thread that called the <xref:System.Transactions.PreparingEnlistment.Prepared%2A> method in phase 1. As such, you should not do any work after the <xref:System.Transactions.PreparingEnlistment.Prepared%2A> call (for example, releasing locks) that you would expect to have completed before receiving the phase 2 notifications.       You can also call the method of the `preparingEnlistment` parameter to indicate a vote for rollback.       If you want the object to merely observe and react to the progress of the transaction, without participating in it, your implementation of this method should call the <xref:System.Transactions.Enlistment.Done%2A> method of the `preparingEnlistment` parameter when it has finished its work. By doing so, your resource manager would not receive any phase 2 notification.","needQuote":false,"needEscape":true,"extradata":"MT","nodes":[{"content":"The transaction manager calls this method of an enlisted resource manager during the phase 1 of a commitment, when it asks participants whether they can commit the transaction.","pos":[0,176]},{"content":"When you are implementing a durable resource manager, you should log your prepare record during this phase.","pos":[183,290]},{"content":"The record should contain all the necessary information to perform recovery.","pos":[291,367]},{"content":"This includes the &lt;xref:System.Transactions.PreparingEnlistment.RecoveryInformation%2A&gt; property, which is passed to the transaction manager in the &lt;xref:System.Transactions.TransactionManager.Reenlist%2A&gt; method during recovery.","pos":[368,597],"source":" This includes the <xref:System.Transactions.PreparingEnlistment.RecoveryInformation%2A> property, which is passed to the transaction manager in the <xref:System.Transactions.TransactionManager.Reenlist%2A> method during recovery."},{"content":"For more information on recovery, see <bpt id=\"p1\">[</bpt>Performing Recovery<ept id=\"p1\">](http://msdn.microsoft.com/en-us/d342c5c7-da64-4a4c-8e63-b52f4fbf2691)</ept>.","pos":[598,728],"source":" For more information on recovery, see [Performing Recovery](http://msdn.microsoft.com/en-us/d342c5c7-da64-4a4c-8e63-b52f4fbf2691)."},{"content":"Your resource manager should complete all work that must be finished before calling the &lt;xref:System.Transactions.PreparingEnlistment.Prepared%2A&gt; method of the <ph id=\"ph1\">`preparingEnlistment`</ph> parameter to indicate its vote for commitment.","pos":[735,964],"source":"       Your resource manager should complete all work that must be finished before calling the <xref:System.Transactions.PreparingEnlistment.Prepared%2A> method of the `preparingEnlistment` parameter to indicate its vote for commitment."},{"content":"You should make sure that this is accomplished before receiving any phase 2 notification such as commit, rollback or in doubt.","pos":[965,1091]},{"content":"This is because phase 2 notifications can happen inline on the same thread that called the &lt;xref:System.Transactions.PreparingEnlistment.Prepared%2A&gt; method in phase 1.","pos":[1092,1260],"source":" This is because phase 2 notifications can happen inline on the same thread that called the <xref:System.Transactions.PreparingEnlistment.Prepared%2A> method in phase 1."},{"content":"As such, you should not do any work after the &lt;xref:System.Transactions.PreparingEnlistment.Prepared%2A&gt; call (for example, releasing locks) that you would expect to have completed before receiving the phase 2 notifications.","pos":[1261,1485],"source":" As such, you should not do any work after the <xref:System.Transactions.PreparingEnlistment.Prepared%2A> call (for example, releasing locks) that you would expect to have completed before receiving the phase 2 notifications."},{"content":"You can also call the method of the <ph id=\"ph1\">`preparingEnlistment`</ph> parameter to indicate a vote for rollback.","pos":[1492,1592],"source":"       You can also call the method of the `preparingEnlistment` parameter to indicate a vote for rollback."},{"content":"If you want the object to merely observe and react to the progress of the transaction, without participating in it, your implementation of this method should call the &lt;xref:System.Transactions.Enlistment.Done%2A&gt; method of the <ph id=\"ph1\">`preparingEnlistment`</ph> parameter when it has finished its work.","pos":[1599,1888],"source":"       If you want the object to merely observe and react to the progress of the transaction, without participating in it, your implementation of this method should call the <xref:System.Transactions.Enlistment.Done%2A> method of the `preparingEnlistment` parameter when it has finished its work."},{"content":"By doing so, your resource manager would not receive any phase 2 notification.","pos":[1889,1967]}]},{"pos":[11881,12002],"content":"A <bpt id=\"p1\">&lt;xref href=\"System.Transactions.PreparingEnlistment\"&gt;</bpt><ept id=\"p1\">&lt;/xref&gt;</ept> object used to send a response to the transaction manager.","needQuote":true,"needEscape":true,"source":"A <xref href=\"System.Transactions.PreparingEnlistment\"></xref> object used to send a response to the transaction manager."},{"pos":[12585,12663],"content":"Notifies an enlisted object that a transaction is being rolled back (aborted).","needQuote":true,"needEscape":true,"nodes":[{"content":"Notifies an enlisted object that a transaction is being rolled back (aborted).","pos":[0,78]}]},{"pos":[12676,14128],"content":"The transaction manager calls this method of an enlisted object when the transaction is being rolled back (aborted) due to the inability of one or more transaction participants to commit the transaction.       The resource manager should perform any work necessary to finish the transaction and then inform the TM that it has finished by calling the <xref:System.Transactions.Enlistment.Done%2A> method on the `enlistment` parameter.       If the resource manager has enlisted durably, but does not respond by calling <xref:System.Transactions.Enlistment.Done%2A> method, the transaction manager is unsure that the resource manager has received the Rollback call. As such, the transaction manager keeps waiting for a response, and maintains information relevant to this transaction.  If <xref:System.Transactions.Enlistment.Done%2A> is never called, this piece of information is kept around indefinitely in memory or in a system-wide resource. This results in resources not being able to be reclaimed. In the case of a distributed transaction, this could eventually fill the MSDTC log which halts the MSDTC process. In the case of a transaction managed by <xref:System.Transactions>, this results in a gradual and continual increase in the memory consumption of the resource manager's process. Therefore, it is crucial that you call the <xref:System.Transactions.Enlistment.Done%2A> method once your resource manager is done with your prepare work.","needQuote":false,"needEscape":true,"extradata":"MT","nodes":[{"content":"The transaction manager calls this method of an enlisted object when the transaction is being rolled back (aborted) due to the inability of one or more transaction participants to commit the transaction.","pos":[0,203]},{"content":"The resource manager should perform any work necessary to finish the transaction and then inform the TM that it has finished by calling the &lt;xref:System.Transactions.Enlistment.Done%2A&gt; method on the <ph id=\"ph1\">`enlistment`</ph> parameter.","pos":[210,433],"source":"       The resource manager should perform any work necessary to finish the transaction and then inform the TM that it has finished by calling the <xref:System.Transactions.Enlistment.Done%2A> method on the `enlistment` parameter."},{"content":"If the resource manager has enlisted durably, but does not respond by calling &lt;xref:System.Transactions.Enlistment.Done%2A&gt; method, the transaction manager is unsure that the resource manager has received the Rollback call.","pos":[440,663],"source":"       If the resource manager has enlisted durably, but does not respond by calling <xref:System.Transactions.Enlistment.Done%2A> method, the transaction manager is unsure that the resource manager has received the Rollback call."},{"content":"As such, the transaction manager keeps waiting for a response, and maintains information relevant to this transaction.","pos":[664,782]},{"content":"If &lt;xref:System.Transactions.Enlistment.Done%2A&gt; is never called, this piece of information is kept around indefinitely in memory or in a system-wide resource.","pos":[784,943],"source":"  If <xref:System.Transactions.Enlistment.Done%2A> is never called, this piece of information is kept around indefinitely in memory or in a system-wide resource."},{"content":"This results in resources not being able to be reclaimed.","pos":[944,1001]},{"content":"In the case of a distributed transaction, this could eventually fill the MSDTC log which halts the MSDTC process.","pos":[1002,1115]},{"content":"In the case of a transaction managed by &lt;xref:System.Transactions&gt;, this results in a gradual and continual increase in the memory consumption of the resource manager's process.","pos":[1116,1293],"source":" In the case of a transaction managed by <xref:System.Transactions>, this results in a gradual and continual increase in the memory consumption of the resource manager's process."},{"content":"Therefore, it is crucial that you call the &lt;xref:System.Transactions.Enlistment.Done%2A&gt; method once your resource manager is done with your prepare work.","pos":[1294,1448],"source":" Therefore, it is crucial that you call the <xref:System.Transactions.Enlistment.Done%2A> method once your resource manager is done with your prepare work."}]},{"pos":[14318,14430],"content":"A <bpt id=\"p1\">&lt;xref href=\"System.Transactions.Enlistment\"&gt;</bpt><ept id=\"p1\">&lt;/xref&gt;</ept> object used to send a response to the transaction manager.","needQuote":true,"needEscape":true,"source":"A <xref href=\"System.Transactions.Enlistment\"></xref> object used to send a response to the transaction manager."}],"content":"### YamlMime:ManagedReference\nitems:\n- uid: System.Transactions.IEnlistmentNotification\n  id: IEnlistmentNotification\n  children:\n  - System.Transactions.IEnlistmentNotification.Commit(System.Transactions.Enlistment)\n  - System.Transactions.IEnlistmentNotification.InDoubt(System.Transactions.Enlistment)\n  - System.Transactions.IEnlistmentNotification.Prepare(System.Transactions.PreparingEnlistment)\n  - System.Transactions.IEnlistmentNotification.Rollback(System.Transactions.Enlistment)\n  langs:\n  - csharp\n  name: IEnlistmentNotification\n  nameWithType: IEnlistmentNotification\n  fullName: System.Transactions.IEnlistmentNotification\n  type: Interface\n  summary: Describes an interface that a resource manager should implement to provide two phase commit notification callbacks for the transaction manager upon enlisting for participation.\n  remarks: \"In order for a resource manager to participate in a transaction, it must enlist in the transaction through the transaction manager. The <xref:System.Transactions.Transaction> class defines a set of methods whose names begin with `Enlist` that provide this functionality. The different `Enlist` methods correspond to the different types of enlistment that a resource maanger may have.  \\n  \\n This class describes an interface that a resource manager should implement to provide two phase commit notification callbacks for the transaction manager upon enlisting for participation. For each resource manager's implementation of the IEnlistmentNotification interface, you should enlist it using the <xref:System.Transactions.Transaction.EnlistVolatile%2A> method or the <xref:System.Transactions.Transaction.EnlistDurable%2A> method of the <xref:System.Transactions.Transaction> class, depending on whether your resource is volatile or durable. For more information on enlistment and 2PC, see [Enlisting Resources as Participants in a Transaction](~/add/includes/ajax-current-ext-md.md) and [Committing a Transaction in Single-Phase and Multi-Phase](~/add/includes/ajax-current-ext-md.md) respectively.  \\n  \\n The transaction manager notifies the enlisted object at different phases of the Two Phase Commit Protocol by the following methods.  \\n  \\n|Method|Description|  \\n|------------|-----------------|  \\n|<xref:System.Transactions.IEnlistmentNotification.Prepare%2A>|This method of an enlisted object is used as a callback by the Transaction Manager during the first phase of a transaction, when the transaction manager asks participants whether they can commit the transaction.|  \\n|<xref:System.Transactions.IEnlistmentNotification.Commit%2A>|This method of an enlisted object is used as a callback by the Transaction Manager during the second phase of a transaction if the transaction is commited.|  \\n|<xref:System.Transactions.IEnlistmentNotification.Rollback%2A>|This method of an enlisted object is used as a callback by the Transaction Manager during the second phase of a transaction if the transaction is aborted (that is, rolled back).|  \\n|<xref:System.Transactions.IEnlistmentNotification.InDoubt%2A>|This method of an enlisted object is used as a callback by the Transaction Manager during the second phase of a transaction if the transaction is in doubt.|  \\n  \\n> [!NOTE]\\n>  You should be aware that notifications might not be sent sequentially, or in a particular order.\"\n  example:\n  - \"The following example shows an implementation of this interface, as well as enlisting the object as a participant in a transaction using the <xref:System.Transactions.Transaction.EnlistVolatile%2A> method.  \\n  \\n [!code-cs[Tx_Enlist#1](~/add/codesnippet/csharp/t-system.transactions.ie_1.cs)]\\n [!code-vb[Tx_Enlist#1](~/add/codesnippet/visualbasic/t-system.transactions.ie_1.vb)]\"\n  syntax:\n    content: public interface IEnlistmentNotification\n  implements: []\n  platform:\n  - net462\n- uid: System.Transactions.IEnlistmentNotification.Commit(System.Transactions.Enlistment)\n  id: Commit(System.Transactions.Enlistment)\n  parent: System.Transactions.IEnlistmentNotification\n  langs:\n  - csharp\n  name: Commit(Enlistment)\n  nameWithType: IEnlistmentNotification.Commit(Enlistment)\n  fullName: System.Transactions.IEnlistmentNotification.Commit(Enlistment)\n  type: Method\n  assemblies:\n  - System.Transactions\n  namespace: System.Transactions\n  summary: Notifies an enlisted object that a transaction is being committed.\n  remarks: \"The transaction manager calls this method of an enlisted object during the second phase of a commitment, when it instructs all participants to commit the transaction.  \\n  \\n The resource manager should perform any work necessary to finish the transaction and then inform the TM that it has finished by calling the <xref:System.Transactions.Enlistment.Done%2A> method on the `enlistment` parameter.  \\n  \\n If the resource manager has enlisted durably, but does not respond by calling <xref:System.Transactions.Enlistment.Done%2A> method, the transaction manager is unsure that the resource manager has received the Commit call. As such, the transaction manager keeps waiting for a response, and maintains information relevant to this transaction.  If <xref:System.Transactions.Enlistment.Done%2A> is never called, this piece of information is kept around indefinitely in memory or in a system-wide resource. This results in resources not being able to be reclaimed. In the case of a distributed transaction, this could eventually fill the MSDTC log which halts the MSDTC process. In the case of a transaction managed by <xref:System.Transactions>, this results in a gradual and continual increase in the memory consumption of the resource manager's process. Therefore, it is crucial that you call the <xref:System.Transactions.Enlistment.Done%2A> method once your resource manager is done with your prepare work.\"\n  syntax:\n    content: public void Commit (System.Transactions.Enlistment enlistment);\n    parameters:\n    - id: enlistment\n      type: System.Transactions.Enlistment\n      description: An <xref href=\"System.Transactions.Enlistment\"></xref> object used to send a response to the transaction manager.\n  overload: System.Transactions.IEnlistmentNotification.Commit*\n  exceptions: []\n  platform:\n  - net462\n- uid: System.Transactions.IEnlistmentNotification.InDoubt(System.Transactions.Enlistment)\n  id: InDoubt(System.Transactions.Enlistment)\n  parent: System.Transactions.IEnlistmentNotification\n  langs:\n  - csharp\n  name: InDoubt(Enlistment)\n  nameWithType: IEnlistmentNotification.InDoubt(Enlistment)\n  fullName: System.Transactions.IEnlistmentNotification.InDoubt(Enlistment)\n  type: Method\n  assemblies:\n  - System.Transactions\n  namespace: System.Transactions\n  summary: Notifies an enlisted object that the status of a transaction is in doubt.\n  remarks: \"This method is called for volatile resources when the transaction manager has invoked a single phase commit operation to a single durable resource, and then connection to the durable resource was lost prior to getting the transaction result. At that point, the transaction outcome cannot be safely determined.  \\n  \\n As InDoubt is considered to be a final state for a transaction, you should not call <xref:System.Transactions.IEnlistmentNotification.Commit%2A> or <xref:System.Transactions.IEnlistmentNotification.Rollback%2A> after calling InDoubt.  \\n  \\n> [!NOTE]\\n>  Your implementation of this method for the volatile resource should perform whatever recovery or containment operation it understands on the affected data.  It must also call the <xref:System.Transactions.Enlistment.Done%2A> method on the on the `enlistment` parameter when it has finished its work.  \\n  \\n If the resource manager has enlisted durably, but does not respond by calling <xref:System.Transactions.Enlistment.Done%2A> method, the transaction manager is unsure that the resource manager has received the InDoubt call. As such, the transaction manager keeps waiting for a response, and maintains information relevant to this transaction.  If <xref:System.Transactions.Enlistment.Done%2A> is never called, this piece of information is kept around indefinitely in memory or in a system-wide resource. This results in resources not being able to be reclaimed. In the case of a distributed transaction, this could eventually fill the MSDTC log which halts the MSDTC process. In the case of a transaction managed by <xref:System.Transactions>, this results in a gradual and continual increase in the memory consumption of the resource manager's process. Therefore, it is crucial that you call the <xref:System.Transactions.Enlistment.Done%2A> method once your resource manager is done with your prepare work.\"\n  syntax:\n    content: public void InDoubt (System.Transactions.Enlistment enlistment);\n    parameters:\n    - id: enlistment\n      type: System.Transactions.Enlistment\n      description: An <xref href=\"System.Transactions.Enlistment\"></xref> object used to send a response to the transaction manager.\n  overload: System.Transactions.IEnlistmentNotification.InDoubt*\n  exceptions: []\n  platform:\n  - net462\n- uid: System.Transactions.IEnlistmentNotification.Prepare(System.Transactions.PreparingEnlistment)\n  id: Prepare(System.Transactions.PreparingEnlistment)\n  parent: System.Transactions.IEnlistmentNotification\n  langs:\n  - csharp\n  name: Prepare(PreparingEnlistment)\n  nameWithType: IEnlistmentNotification.Prepare(PreparingEnlistment)\n  fullName: System.Transactions.IEnlistmentNotification.Prepare(PreparingEnlistment)\n  type: Method\n  assemblies:\n  - System.Transactions\n  namespace: System.Transactions\n  summary: Notifies an enlisted object that a transaction is being prepared for commitment.\n  remarks: \"The transaction manager calls this method of an enlisted resource manager during the phase 1 of a commitment, when it asks participants whether they can commit the transaction.  \\n  \\n When you are implementing a durable resource manager, you should log your prepare record during this phase. The record should contain all the necessary information to perform recovery. This includes the <xref:System.Transactions.PreparingEnlistment.RecoveryInformation%2A> property, which is passed to the transaction manager in the <xref:System.Transactions.TransactionManager.Reenlist%2A> method during recovery. For more information on recovery, see [Performing Recovery](http://msdn.microsoft.com/en-us/d342c5c7-da64-4a4c-8e63-b52f4fbf2691).  \\n  \\n Your resource manager should complete all work that must be finished before calling the <xref:System.Transactions.PreparingEnlistment.Prepared%2A> method of the `preparingEnlistment` parameter to indicate its vote for commitment. You should make sure that this is accomplished before receiving any phase 2 notification such as commit, rollback or in doubt. This is because phase 2 notifications can happen inline on the same thread that called the <xref:System.Transactions.PreparingEnlistment.Prepared%2A> method in phase 1. As such, you should not do any work after the <xref:System.Transactions.PreparingEnlistment.Prepared%2A> call (for example, releasing locks) that you would expect to have completed before receiving the phase 2 notifications.  \\n  \\n You can also call the method of the `preparingEnlistment` parameter to indicate a vote for rollback.  \\n  \\n If you want the object to merely observe and react to the progress of the transaction, without participating in it, your implementation of this method should call the <xref:System.Transactions.Enlistment.Done%2A> method of the `preparingEnlistment` parameter when it has finished its work. By doing so, your resource manager would not receive any phase 2 notification.\"\n  syntax:\n    content: public void Prepare (System.Transactions.PreparingEnlistment preparingEnlistment);\n    parameters:\n    - id: preparingEnlistment\n      type: System.Transactions.PreparingEnlistment\n      description: A <xref href=\"System.Transactions.PreparingEnlistment\"></xref> object used to send a response to the transaction manager.\n  overload: System.Transactions.IEnlistmentNotification.Prepare*\n  exceptions: []\n  platform:\n  - net462\n- uid: System.Transactions.IEnlistmentNotification.Rollback(System.Transactions.Enlistment)\n  id: Rollback(System.Transactions.Enlistment)\n  parent: System.Transactions.IEnlistmentNotification\n  langs:\n  - csharp\n  name: Rollback(Enlistment)\n  nameWithType: IEnlistmentNotification.Rollback(Enlistment)\n  fullName: System.Transactions.IEnlistmentNotification.Rollback(Enlistment)\n  type: Method\n  assemblies:\n  - System.Transactions\n  namespace: System.Transactions\n  summary: Notifies an enlisted object that a transaction is being rolled back (aborted).\n  remarks: \"The transaction manager calls this method of an enlisted object when the transaction is being rolled back (aborted) due to the inability of one or more transaction participants to commit the transaction.  \\n  \\n The resource manager should perform any work necessary to finish the transaction and then inform the TM that it has finished by calling the <xref:System.Transactions.Enlistment.Done%2A> method on the `enlistment` parameter.  \\n  \\n If the resource manager has enlisted durably, but does not respond by calling <xref:System.Transactions.Enlistment.Done%2A> method, the transaction manager is unsure that the resource manager has received the Rollback call. As such, the transaction manager keeps waiting for a response, and maintains information relevant to this transaction.  If <xref:System.Transactions.Enlistment.Done%2A> is never called, this piece of information is kept around indefinitely in memory or in a system-wide resource. This results in resources not being able to be reclaimed. In the case of a distributed transaction, this could eventually fill the MSDTC log which halts the MSDTC process. In the case of a transaction managed by <xref:System.Transactions>, this results in a gradual and continual increase in the memory consumption of the resource manager's process. Therefore, it is crucial that you call the <xref:System.Transactions.Enlistment.Done%2A> method once your resource manager is done with your prepare work.\"\n  syntax:\n    content: public void Rollback (System.Transactions.Enlistment enlistment);\n    parameters:\n    - id: enlistment\n      type: System.Transactions.Enlistment\n      description: A <xref href=\"System.Transactions.Enlistment\"></xref> object used to send a response to the transaction manager.\n  overload: System.Transactions.IEnlistmentNotification.Rollback*\n  exceptions: []\n  platform:\n  - net462\nreferences:\n- uid: System.Transactions.IEnlistmentNotification.Commit(System.Transactions.Enlistment)\n  parent: System.Transactions.IEnlistmentNotification\n  isExternal: false\n  name: Commit(Enlistment)\n  nameWithType: IEnlistmentNotification.Commit(Enlistment)\n  fullName: System.Transactions.IEnlistmentNotification.Commit(Enlistment)\n- uid: System.Transactions.Enlistment\n  parent: System.Transactions\n  isExternal: false\n  name: Enlistment\n  nameWithType: Enlistment\n  fullName: System.Transactions.Enlistment\n- uid: System.Transactions.IEnlistmentNotification.InDoubt(System.Transactions.Enlistment)\n  parent: System.Transactions.IEnlistmentNotification\n  isExternal: false\n  name: InDoubt(Enlistment)\n  nameWithType: IEnlistmentNotification.InDoubt(Enlistment)\n  fullName: System.Transactions.IEnlistmentNotification.InDoubt(Enlistment)\n- uid: System.Transactions.IEnlistmentNotification.Prepare(System.Transactions.PreparingEnlistment)\n  parent: System.Transactions.IEnlistmentNotification\n  isExternal: false\n  name: Prepare(PreparingEnlistment)\n  nameWithType: IEnlistmentNotification.Prepare(PreparingEnlistment)\n  fullName: System.Transactions.IEnlistmentNotification.Prepare(PreparingEnlistment)\n- uid: System.Transactions.PreparingEnlistment\n  parent: System.Transactions\n  isExternal: false\n  name: PreparingEnlistment\n  nameWithType: PreparingEnlistment\n  fullName: System.Transactions.PreparingEnlistment\n- uid: System.Transactions.IEnlistmentNotification.Rollback(System.Transactions.Enlistment)\n  parent: System.Transactions.IEnlistmentNotification\n  isExternal: false\n  name: Rollback(Enlistment)\n  nameWithType: IEnlistmentNotification.Rollback(Enlistment)\n  fullName: System.Transactions.IEnlistmentNotification.Rollback(Enlistment)\n- uid: System.Transactions.IEnlistmentNotification.Commit*\n  parent: System.Transactions.IEnlistmentNotification\n  isExternal: false\n  name: Commit\n  nameWithType: IEnlistmentNotification.Commit\n- uid: System.Transactions.IEnlistmentNotification.InDoubt*\n  parent: System.Transactions.IEnlistmentNotification\n  isExternal: false\n  name: InDoubt\n  nameWithType: IEnlistmentNotification.InDoubt\n- uid: System.Transactions.IEnlistmentNotification.Prepare*\n  parent: System.Transactions.IEnlistmentNotification\n  isExternal: false\n  name: Prepare\n  nameWithType: IEnlistmentNotification.Prepare\n- uid: System.Transactions.IEnlistmentNotification.Rollback*\n  parent: System.Transactions.IEnlistmentNotification\n  isExternal: false\n  name: Rollback\n  nameWithType: IEnlistmentNotification.Rollback\n"}