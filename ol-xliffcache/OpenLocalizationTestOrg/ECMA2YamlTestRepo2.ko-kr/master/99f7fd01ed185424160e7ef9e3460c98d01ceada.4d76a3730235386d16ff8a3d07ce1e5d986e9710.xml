{"nodes":[{"pos":[730,778],"content":"Provides a Message Queuing internal transaction.","needQuote":true,"needEscape":true,"nodes":[{"content":"Provides a Message Queuing internal transaction.","pos":[0,48]}]},{"pos":[791,2921],"content":"To send or receive a message as part of a transaction, you can use the MessageQueueTransaction class to create a transaction and pass it to an overload of the <xref:System.Messaging.MessageQueue.Send%2A?displayProperty=fullName> method or the <xref:System.Messaging.MessageQueue.Receive%2A?displayProperty=fullName> method that takes a `transaction` parameter. Messages sent as part of a transaction must be sent to transactional queues. Messages received from transactional queues must be received using a specified transaction.       In addition to the <xref:System.Messaging.MessageQueue.Receive%2A> method, you can receive messages with a specified identifier or specified correlation identifier. See the <xref:System.Messaging.MessageQueue.ReceiveById%2A> and <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%2A> methods for more information about selectively receiving messages from transactional queues.       Messages sent to transactional queues are removed if the transaction is committed. Similarly, messages received from transactional queues are returned to the queue if the transaction is rolled back.       If you instantiate a MessageQueueTransaction and pass it to an applicable overload of the <xref:System.Messaging.MessageQueue.Send%2A> method or <xref:System.Messaging.MessageQueue.Receive%2A> method to send a message to a non-transactional queue or receive a message from a non-transactional queue, the method throws an exception that indicates \"Wrong Transaction Usage.\"       [Visual Basic]       MessageQueueTransaction is threading apartment aware, so if your apartment state is `STA`, you cannot use the transaction in multiple threads. Visual Basic sets the state of the main thread to `STA`, so you must apply the <xref:System.MTAThreadAttribute> in the `Main` subroutine. Otherwise, sending a transactional message using another thread throws a <xref:System.Messaging.MessageQueueException> exception. You apply the <xref:System.MTAThreadAttribute> by using the following fragment.      ```   <System.MTAThreadAttribute>    public sub Main()   ```      ```vb#      ```","needQuote":false,"needEscape":true,"extradata":"MT","nodes":[{"content":"To send or receive a message as part of a transaction, you can use the MessageQueueTransaction class to create a transaction and pass it to an overload of the &lt;xref:System.Messaging.MessageQueue.Send%2A?displayProperty=fullName&gt; method or the &lt;xref:System.Messaging.MessageQueue.Receive%2A?displayProperty=fullName&gt; method that takes a <ph id=\"ph1\">`transaction`</ph> parameter.","pos":[0,360],"source":"To send or receive a message as part of a transaction, you can use the MessageQueueTransaction class to create a transaction and pass it to an overload of the <xref:System.Messaging.MessageQueue.Send%2A?displayProperty=fullName> method or the <xref:System.Messaging.MessageQueue.Receive%2A?displayProperty=fullName> method that takes a `transaction` parameter."},{"content":"Messages sent as part of a transaction must be sent to transactional queues.","pos":[361,437]},{"content":"Messages received from transactional queues must be received using a specified transaction.","pos":[438,529]},{"content":"In addition to the &lt;xref:System.Messaging.MessageQueue.Receive%2A&gt; method, you can receive messages with a specified identifier or specified correlation identifier.","pos":[536,700],"source":"       In addition to the <xref:System.Messaging.MessageQueue.Receive%2A> method, you can receive messages with a specified identifier or specified correlation identifier."},{"content":"See the &lt;xref:System.Messaging.MessageQueue.ReceiveById%2A&gt; and &lt;xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%2A&gt; methods for more information about selectively receiving messages from transactional queues.","pos":[701,920],"source":" See the <xref:System.Messaging.MessageQueue.ReceiveById%2A> and <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%2A> methods for more information about selectively receiving messages from transactional queues."},{"content":"Messages sent to transactional queues are removed if the transaction is committed.","pos":[927,1009]},{"content":"Similarly, messages received from transactional queues are returned to the queue if the transaction is rolled back.","pos":[1010,1125]},{"content":"If you instantiate a MessageQueueTransaction and pass it to an applicable overload of the &lt;xref:System.Messaging.MessageQueue.Send%2A&gt; method or &lt;xref:System.Messaging.MessageQueue.Receive%2A&gt; method to send a message to a non-transactional queue or receive a message from a non-transactional queue, the method throws an exception that indicates \"Wrong Transaction Usage.\"","pos":[1132,1504],"source":"       If you instantiate a MessageQueueTransaction and pass it to an applicable overload of the <xref:System.Messaging.MessageQueue.Send%2A> method or <xref:System.Messaging.MessageQueue.Receive%2A> method to send a message to a non-transactional queue or receive a message from a non-transactional queue, the method throws an exception that indicates \"Wrong Transaction Usage.\""},{"content":"[Visual Basic]       MessageQueueTransaction is threading apartment aware, so if your apartment state is <ph id=\"ph1\">`STA`</ph>, you cannot use the transaction in multiple threads.","pos":[1511,1674],"source":"       [Visual Basic]       MessageQueueTransaction is threading apartment aware, so if your apartment state is `STA`, you cannot use the transaction in multiple threads."},{"content":"Visual Basic sets the state of the main thread to <ph id=\"ph1\">`STA`</ph>, so you must apply the &lt;xref:System.MTAThreadAttribute&gt; in the <ph id=\"ph2\">`Main`</ph> subroutine.","pos":[1675,1812],"source":" Visual Basic sets the state of the main thread to `STA`, so you must apply the <xref:System.MTAThreadAttribute> in the `Main` subroutine."},{"content":"Otherwise, sending a transactional message using another thread throws a &lt;xref:System.Messaging.MessageQueueException&gt; exception.","pos":[1813,1942],"source":" Otherwise, sending a transactional message using another thread throws a <xref:System.Messaging.MessageQueueException> exception."},{"content":"You apply the &lt;xref:System.MTAThreadAttribute&gt; by using the following fragment.","pos":[1943,2022],"source":" You apply the <xref:System.MTAThreadAttribute> by using the following fragment."},{"content":"<ph id=\"ph1\">```   &lt;System.MTAThreadAttribute&gt;    public sub Main()   ```</ph>      <ph id=\"ph2\">```vb#      ```</ph>","pos":[2028,2109],"source":"```   <System.MTAThreadAttribute>    public sub Main()   ```      ```vb#      ```"}]},{"pos":[3529,3631],"content":"Initializes a new instance of the <bpt id=\"p1\">&lt;xref href=\"System.Messaging.MessageQueueTransaction\"&gt;</bpt><ept id=\"p1\">&lt;/xref&gt;</ept> class.","needQuote":true,"needEscape":true,"source":"Initializes a new instance of the <xref href=\"System.Messaging.MessageQueueTransaction\"></xref> class."},{"pos":[3643,3753],"content":"This constructor sets the &lt;xref:System.Messaging.MessageQueueTransaction.Status%2A&gt; property to <ph id=\"ph1\">`Initialized`</ph>.","needQuote":true,"needEscape":true,"extradata":"MT","source":"This constructor sets the <xref:System.Messaging.MessageQueueTransaction.Status%2A> property to `Initialized`."},{"pos":[4284,4328],"content":"Rolls back the pending internal transaction.","needQuote":true,"needEscape":true,"nodes":[{"content":"Rolls back the pending internal transaction.","pos":[0,44]}]},{"pos":[4341,4924],"content":"Abort marks the unsuccessful completion of a process begun at a call to <xref:System.Messaging.MessageQueueTransaction.Begin%2A>.       Typically, one makes a call to <xref:System.Messaging.MessageQueueTransaction.Begin%2A> within a `Try...Catch` exception-handling block, putting a call to <xref:System.Messaging.MessageQueueTransaction.Commit%2A> in the `Try` clause, and a call to Abort in the `Catch` clause.       Abort rolls back the entire transaction. This includes all messages sent or received after the call to <xref:System.Messaging.MessageQueueTransaction.Begin%2A>.","needQuote":false,"needEscape":true,"extradata":"MT","nodes":[{"content":"Abort marks the unsuccessful completion of a process begun at a call to &lt;xref:System.Messaging.MessageQueueTransaction.Begin%2A&gt;.","pos":[0,129],"source":"Abort marks the unsuccessful completion of a process begun at a call to <xref:System.Messaging.MessageQueueTransaction.Begin%2A>."},{"content":"Typically, one makes a call to &lt;xref:System.Messaging.MessageQueueTransaction.Begin%2A&gt; within a <ph id=\"ph1\">`Try...Catch`</ph> exception-handling block, putting a call to &lt;xref:System.Messaging.MessageQueueTransaction.Commit%2A&gt; in the <ph id=\"ph2\">`Try`</ph> clause, and a call to Abort in the <ph id=\"ph3\">`Catch`</ph> clause.","pos":[136,412],"source":"       Typically, one makes a call to <xref:System.Messaging.MessageQueueTransaction.Begin%2A> within a `Try...Catch` exception-handling block, putting a call to <xref:System.Messaging.MessageQueueTransaction.Commit%2A> in the `Try` clause, and a call to Abort in the `Catch` clause."},{"content":"Abort rolls back the entire transaction.","pos":[419,459]},{"content":"This includes all messages sent or received after the call to &lt;xref:System.Messaging.MessageQueueTransaction.Begin%2A&gt;.","pos":[460,579],"source":" This includes all messages sent or received after the call to <xref:System.Messaging.MessageQueueTransaction.Begin%2A>."}]},{"pos":[5174,5247],"content":"The internal transaction you are attempting to roll back has not started.","needQuote":true,"needEscape":true,"nodes":[{"content":"The internal transaction you are attempting to roll back has not started.","pos":[0,73]}]},{"pos":[5370,5411],"content":"An internal Message Queuing error occurs.","needQuote":true,"needEscape":true,"nodes":[{"content":"An internal Message Queuing error occurs.","pos":[0,41]}]},{"pos":[5788,5838],"content":"Begins a new Message Queuing internal transaction.","needQuote":true,"needEscape":true,"nodes":[{"content":"Begins a new Message Queuing internal transaction.","pos":[0,50]}]},{"pos":[5851,6405],"content":"Begin marks the start of processing that will be committed or rolled back, depending on the success of the transaction. If an exception occurs during processing, the entire transaction is rolled back. This includes all messages sent or received after the call to Begin.       Typically, one makes a call to Begin within a `Try...Catch` exception-handling block, putting a call to <xref:System.Messaging.MessageQueueTransaction.Commit%2A> in the `Try` clause, and a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A> in the `Catch` clause.","needQuote":false,"needEscape":true,"extradata":"MT","nodes":[{"content":"Begin marks the start of processing that will be committed or rolled back, depending on the success of the transaction.","pos":[0,119]},{"content":"If an exception occurs during processing, the entire transaction is rolled back.","pos":[120,200]},{"content":"This includes all messages sent or received after the call to Begin.","pos":[201,269]},{"content":"Typically, one makes a call to Begin within a <ph id=\"ph1\">`Try...Catch`</ph> exception-handling block, putting a call to &lt;xref:System.Messaging.MessageQueueTransaction.Commit%2A&gt; in the <ph id=\"ph2\">`Try`</ph> clause, and a call to &lt;xref:System.Messaging.MessageQueueTransaction.Abort%2A&gt; in the <ph id=\"ph3\">`Catch`</ph> clause.","pos":[276,552],"source":"       Typically, one makes a call to Begin within a `Try...Catch` exception-handling block, putting a call to <xref:System.Messaging.MessageQueueTransaction.Commit%2A> in the `Try` clause, and a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A> in the `Catch` clause."}]},{"pos":[6655,6696],"content":"The transaction has already been started.","needQuote":true,"needEscape":true,"nodes":[{"content":"The transaction has already been started.","pos":[0,41]}]},{"pos":[6819,6860],"content":"An internal Message Queuing error occurs.","needQuote":true,"needEscape":true,"nodes":[{"content":"An internal Message Queuing error occurs.","pos":[0,41]}]},{"pos":[7242,7281],"content":"Commits a pending internal transaction.","needQuote":true,"needEscape":true,"nodes":[{"content":"Commits a pending internal transaction.","pos":[0,39]}]},{"pos":[7294,7992],"content":"Commit marks the successful completion of processing begun at a call to <xref:System.Messaging.MessageQueueTransaction.Begin%2A>. If an exception occurs between the call the <xref:System.Messaging.MessageQueueTransaction.Begin%2A> and the call to Commit, the entire transaction is rolled back. This includes all messages sent or received after the call to <xref:System.Messaging.MessageQueueTransaction.Begin%2A>.       Typically, one makes a call to <xref:System.Messaging.MessageQueueTransaction.Begin%2A> within a `Try...Catch` exception-handling block, putting a call to Commit in the `Try` clause, and a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A> in the `Catch` clause.","needQuote":false,"needEscape":true,"extradata":"MT","nodes":[{"content":"Commit marks the successful completion of processing begun at a call to &lt;xref:System.Messaging.MessageQueueTransaction.Begin%2A&gt;.","pos":[0,129],"source":"Commit marks the successful completion of processing begun at a call to <xref:System.Messaging.MessageQueueTransaction.Begin%2A>."},{"content":"If an exception occurs between the call the &lt;xref:System.Messaging.MessageQueueTransaction.Begin%2A&gt; and the call to Commit, the entire transaction is rolled back.","pos":[130,293],"source":" If an exception occurs between the call the <xref:System.Messaging.MessageQueueTransaction.Begin%2A> and the call to Commit, the entire transaction is rolled back."},{"content":"This includes all messages sent or received after the call to &lt;xref:System.Messaging.MessageQueueTransaction.Begin%2A&gt;.","pos":[294,413],"source":" This includes all messages sent or received after the call to <xref:System.Messaging.MessageQueueTransaction.Begin%2A>."},{"content":"Typically, one makes a call to &lt;xref:System.Messaging.MessageQueueTransaction.Begin%2A&gt; within a <ph id=\"ph1\">`Try...Catch`</ph> exception-handling block, putting a call to Commit in the <ph id=\"ph2\">`Try`</ph> clause, and a call to &lt;xref:System.Messaging.MessageQueueTransaction.Abort%2A&gt; in the <ph id=\"ph3\">`Catch`</ph> clause.","pos":[420,696],"source":"       Typically, one makes a call to <xref:System.Messaging.MessageQueueTransaction.Begin%2A> within a `Try...Catch` exception-handling block, putting a call to Commit in the `Try` clause, and a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A> in the `Catch` clause."}]},{"pos":[8244,8301],"content":"The transaction you are trying to commit has not started.","needQuote":true,"needEscape":true,"nodes":[{"content":"The transaction you are trying to commit has not started.","pos":[0,57]}]},{"pos":[8424,8465],"content":"An internal Message Queuing error occurs.","needQuote":true,"needEscape":true,"nodes":[{"content":"An internal Message Queuing error occurs.","pos":[0,41]}]},{"pos":[8852,8949],"content":"Releases all resources used by the <bpt id=\"p1\">&lt;xref href=\"System.Messaging.MessageQueueTransaction\"&gt;</bpt><ept id=\"p1\">&lt;/xref&gt;</ept>.","needQuote":true,"needEscape":true,"source":"Releases all resources used by the <xref href=\"System.Messaging.MessageQueueTransaction\"></xref>."},{"pos":[8962,9282],"content":"Calling Dispose allows the resources used by the <xref:System.Messaging.MessageQueueTransaction> to be reallocated for other purposes. For more information about `Dispose`, see [Cleaning Up Unmanaged Resources](~/add/includes/ajax-current-ext-md.md).       Any pending internal transactions are rolled back by Dispose.","needQuote":false,"needEscape":true,"extradata":"MT","nodes":[{"content":"Calling Dispose allows the resources used by the &lt;xref:System.Messaging.MessageQueueTransaction&gt; to be reallocated for other purposes.","pos":[0,134],"source":"Calling Dispose allows the resources used by the <xref:System.Messaging.MessageQueueTransaction> to be reallocated for other purposes."},{"content":"For more information about <ph id=\"ph1\">`Dispose`</ph>, see <bpt id=\"p1\">[</bpt>Cleaning Up Unmanaged Resources<ept id=\"p1\">](~/add/includes/ajax-current-ext-md.md)</ept>.","pos":[135,250],"source":" For more information about `Dispose`, see [Cleaning Up Unmanaged Resources](~/add/includes/ajax-current-ext-md.md)."},{"content":"Any pending internal transactions are rolled back by Dispose.","pos":[257,318]}]},{"pos":[9868,10021],"content":"Releases the unmanaged resources used by the <bpt id=\"p1\">&lt;xref href=\"System.Messaging.MessageQueueTransaction\"&gt;</bpt><ept id=\"p1\">&lt;/xref&gt;</ept> and optionally releases the managed resources.","needQuote":true,"needEscape":true,"source":"Releases the unmanaged resources used by the <xref href=\"System.Messaging.MessageQueueTransaction\"></xref> and optionally releases the managed resources."},{"pos":[10034,10623],"content":"This method is called by the public <xref:System.Messaging.MessageQueueTransaction.Dispose%2A> method and the <xref:System.Object.Finalize%2A> method. `Dispose` invokes the protected `Dispose(Boolean)` method with the `disposing` parameter set to `true`. <xref:System.Object.Finalize%2A> invokes `Dispose` with `disposing` set to `false`.       When the `disposing` parameter is `true`, this method releases all resources held by any managed objects that this <xref:System.Messaging.MessageQueueTransaction> references. This method invokes the `Dispose` method of each referenced object.","needQuote":false,"needEscape":true,"extradata":"MT","nodes":[{"content":"This method is called by the public &lt;xref:System.Messaging.MessageQueueTransaction.Dispose%2A&gt; method and the &lt;xref:System.Object.Finalize%2A&gt; method.","pos":[0,150],"source":"This method is called by the public <xref:System.Messaging.MessageQueueTransaction.Dispose%2A> method and the <xref:System.Object.Finalize%2A> method."},{"content":"<ph id=\"ph1\">`Dispose`</ph> invokes the protected <ph id=\"ph2\">`Dispose(Boolean)`</ph> method with the <ph id=\"ph3\">`disposing`</ph> parameter set to <ph id=\"ph4\">`true`</ph>.","pos":[151,254],"source":"`Dispose` invokes the protected `Dispose(Boolean)` method with the `disposing` parameter set to `true`."},{"content":"&lt;xref:System.Object.Finalize%2A&gt; invokes <ph id=\"ph1\">`Dispose`</ph> with <ph id=\"ph2\">`disposing`</ph> set to <ph id=\"ph3\">`false`</ph>.","pos":[255,338],"source":" <xref:System.Object.Finalize%2A> invokes `Dispose` with `disposing` set to `false`."},{"content":"When the <ph id=\"ph1\">`disposing`</ph> parameter is <ph id=\"ph2\">`true`</ph>, this method releases all resources held by any managed objects that this &lt;xref:System.Messaging.MessageQueueTransaction&gt; references.","pos":[345,519],"source":"       When the `disposing` parameter is `true`, this method releases all resources held by any managed objects that this <xref:System.Messaging.MessageQueueTransaction> references."},{"content":"This method invokes the <ph id=\"ph1\">`Dispose`</ph> method of each referenced object.","pos":[520,587],"source":" This method invokes the `Dispose` method of each referenced object."}]},{"pos":[10779,10988],"content":"<bpt id=\"p1\">&lt;xref uid=\"langword_csharp_true\" name=\"true\" href=\"\"&gt;</bpt><ept id=\"p1\">&lt;/xref&gt;</ept> to release both managed and unmanaged resources; <bpt id=\"p2\">&lt;xref uid=\"langword_csharp_false\" name=\"false\" href=\"\"&gt;</bpt><ept id=\"p2\">&lt;/xref&gt;</ept> to release only unmanaged resources.","needQuote":true,"needEscape":true,"source":"<xref uid=\"langword_csharp_true\" name=\"true\" href=\"\"></xref> to release both managed and unmanaged resources; <xref uid=\"langword_csharp_false\" name=\"false\" href=\"\"></xref> to release only unmanaged resources."},{"pos":[11459,11511],"content":"Releases the resources held by the current instance.","needQuote":true,"needEscape":true,"nodes":[{"content":"Releases the resources held by the current instance.","pos":[0,52]}]},{"pos":[11524,12202],"content":"This method overrides <xref:System.Object.Finalize%2A?displayProperty=fullName>. Application code should not call this method; an object's Finalize method is automatically invoked during garbage collection, unless finalization by the garbage collector has been disabled by a call to the <xref:System.GC.SuppressFinalize%2A?displayProperty=fullName> method.       For more information, see [Finalize Methods and Destructors](http://msdn.microsoft.com/en-us/fd376774-1643-499b-869e-9546a3aeea70), [Cleaning Up Unmanaged Resources](~/add/includes/ajax-current-ext-md.md), and [Overriding the Finalize Method](http://msdn.microsoft.com/en-us/8026cb68-fe93-43fc-96c1-c09ad7d64cd3).","needQuote":false,"needEscape":true,"extradata":"MT","nodes":[{"content":"This method overrides &lt;xref:System.Object.Finalize%2A?displayProperty=fullName&gt;.","pos":[0,80],"source":"This method overrides <xref:System.Object.Finalize%2A?displayProperty=fullName>."},{"content":"Application code should not call this method; an object's Finalize method is automatically invoked during garbage collection, unless finalization by the garbage collector has been disabled by a call to the &lt;xref:System.GC.SuppressFinalize%2A?displayProperty=fullName&gt; method.","pos":[81,356],"source":" Application code should not call this method; an object's Finalize method is automatically invoked during garbage collection, unless finalization by the garbage collector has been disabled by a call to the <xref:System.GC.SuppressFinalize%2A?displayProperty=fullName> method."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Finalize Methods and Destructors<ept id=\"p1\">](http://msdn.microsoft.com/en-us/fd376774-1643-499b-869e-9546a3aeea70)</ept>, <bpt id=\"p2\">[</bpt>Cleaning Up Unmanaged Resources<ept id=\"p2\">](~/add/includes/ajax-current-ext-md.md)</ept>, and <bpt id=\"p3\">[</bpt>Overriding the Finalize Method<ept id=\"p3\">](http://msdn.microsoft.com/en-us/8026cb68-fe93-43fc-96c1-c09ad7d64cd3)</ept>.","pos":[363,676],"source":"       For more information, see [Finalize Methods and Destructors](http://msdn.microsoft.com/en-us/fd376774-1643-499b-869e-9546a3aeea70), [Cleaning Up Unmanaged Resources](~/add/includes/ajax-current-ext-md.md), and [Overriding the Finalize Method](http://msdn.microsoft.com/en-us/8026cb68-fe93-43fc-96c1-c09ad7d64cd3)."}]},{"pos":[12732,12767],"content":"Gets the status of the transaction.","needQuote":true,"needEscape":true,"nodes":[{"content":"Gets the status of the transaction.","pos":[0,35]}]},{"pos":[12779,13167],"content":"When an instance of the <xref:System.Messaging.MessageQueueTransaction> class has been created, the Status is set by the constructor to `Initialized`. After a call to <xref:System.Messaging.MessageQueueTransaction.Begin%2A> but before a call to <xref:System.Messaging.MessageQueueTransaction.Commit%2A> or <xref:System.Messaging.MessageQueueTransaction.Abort%2A>, the Status is `Pending`.","needQuote":true,"needEscape":true,"extradata":"MT","nodes":[{"content":"When an instance of the &lt;xref:System.Messaging.MessageQueueTransaction&gt; class has been created, the Status is set by the constructor to <ph id=\"ph1\">`Initialized`</ph>.","pos":[0,150],"source":"When an instance of the <xref:System.Messaging.MessageQueueTransaction> class has been created, the Status is set by the constructor to `Initialized`."},{"content":"After a call to &lt;xref:System.Messaging.MessageQueueTransaction.Begin%2A&gt; but before a call to &lt;xref:System.Messaging.MessageQueueTransaction.Commit%2A&gt; or &lt;xref:System.Messaging.MessageQueueTransaction.Abort%2A&gt;, the Status is <ph id=\"ph1\">`Pending`</ph>.","pos":[151,388],"source":" After a call to <xref:System.Messaging.MessageQueueTransaction.Begin%2A> but before a call to <xref:System.Messaging.MessageQueueTransaction.Commit%2A> or <xref:System.Messaging.MessageQueueTransaction.Abort%2A>, the Status is `Pending`."}]},{"pos":[13351,13532],"content":"One of the <bpt id=\"p1\">&lt;xref href=\"System.Messaging.MessageQueueTransactionStatus\"&gt;</bpt><ept id=\"p1\">&lt;/xref&gt;</ept> values that indicates whether the transaction has been committed, aborted, initialized, or is pending.","needQuote":true,"needEscape":true,"source":"One of the <xref href=\"System.Messaging.MessageQueueTransactionStatus\"></xref> values that indicates whether the transaction has been committed, aborted, initialized, or is pending."}],"content":"### YamlMime:ManagedReference\nitems:\n- uid: System.Messaging.MessageQueueTransaction\n  id: MessageQueueTransaction\n  children:\n  - System.Messaging.MessageQueueTransaction.#ctor\n  - System.Messaging.MessageQueueTransaction.Abort\n  - System.Messaging.MessageQueueTransaction.Begin\n  - System.Messaging.MessageQueueTransaction.Commit\n  - System.Messaging.MessageQueueTransaction.Dispose\n  - System.Messaging.MessageQueueTransaction.Dispose(System.Boolean)\n  - System.Messaging.MessageQueueTransaction.Finalize\n  - System.Messaging.MessageQueueTransaction.Status\n  langs:\n  - csharp\n  name: MessageQueueTransaction\n  nameWithType: MessageQueueTransaction\n  fullName: System.Messaging.MessageQueueTransaction\n  type: Class\n  summary: Provides a Message Queuing internal transaction.\n  remarks: \"To send or receive a message as part of a transaction, you can use the MessageQueueTransaction class to create a transaction and pass it to an overload of the <xref:System.Messaging.MessageQueue.Send%2A?displayProperty=fullName> method or the <xref:System.Messaging.MessageQueue.Receive%2A?displayProperty=fullName> method that takes a `transaction` parameter. Messages sent as part of a transaction must be sent to transactional queues. Messages received from transactional queues must be received using a specified transaction.  \\n  \\n In addition to the <xref:System.Messaging.MessageQueue.Receive%2A> method, you can receive messages with a specified identifier or specified correlation identifier. See the <xref:System.Messaging.MessageQueue.ReceiveById%2A> and <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%2A> methods for more information about selectively receiving messages from transactional queues.  \\n  \\n Messages sent to transactional queues are removed if the transaction is committed. Similarly, messages received from transactional queues are returned to the queue if the transaction is rolled back.  \\n  \\n If you instantiate a MessageQueueTransaction and pass it to an applicable overload of the <xref:System.Messaging.MessageQueue.Send%2A> method or <xref:System.Messaging.MessageQueue.Receive%2A> method to send a message to a non-transactional queue or receive a message from a non-transactional queue, the method throws an exception that indicates \\\"Wrong Transaction Usage.\\\"  \\n  \\n [Visual Basic]  \\n  \\n MessageQueueTransaction is threading apartment aware, so if your apartment state is `STA`, you cannot use the transaction in multiple threads. Visual Basic sets the state of the main thread to `STA`, so you must apply the <xref:System.MTAThreadAttribute> in the `Main` subroutine. Otherwise, sending a transactional message using another thread throws a <xref:System.Messaging.MessageQueueException> exception. You apply the <xref:System.MTAThreadAttribute> by using the following fragment.  \\n  \\n```  \\n<System.MTAThreadAttribute>  \\n public sub Main()  \\n```  \\n  \\n```vb#  \\n  \\n```\"\n  syntax:\n    content: 'public class MessageQueueTransaction : IDisposable'\n  inheritance:\n  - System.Object\n  implements:\n  - System.IDisposable\n  inheritedMembers: []\n  platform:\n  - net462\n- uid: System.Messaging.MessageQueueTransaction.#ctor\n  id: '#ctor'\n  parent: System.Messaging.MessageQueueTransaction\n  langs:\n  - csharp\n  name: MessageQueueTransaction()\n  nameWithType: MessageQueueTransaction.MessageQueueTransaction()\n  fullName: System.Messaging.MessageQueueTransaction.MessageQueueTransaction()\n  type: Constructor\n  assemblies:\n  - System.Messaging\n  namespace: System.Messaging\n  summary: Initializes a new instance of the <xref href=\"System.Messaging.MessageQueueTransaction\"></xref> class.\n  remarks: This constructor sets the <xref:System.Messaging.MessageQueueTransaction.Status%2A> property to `Initialized`.\n  syntax:\n    content: public MessageQueueTransaction ();\n    parameters: []\n  overload: System.Messaging.MessageQueueTransaction.#ctor*\n  exceptions: []\n  platform:\n  - net462\n- uid: System.Messaging.MessageQueueTransaction.Abort\n  id: Abort\n  parent: System.Messaging.MessageQueueTransaction\n  langs:\n  - csharp\n  name: Abort()\n  nameWithType: MessageQueueTransaction.Abort()\n  fullName: System.Messaging.MessageQueueTransaction.Abort()\n  type: Method\n  assemblies:\n  - System.Messaging\n  namespace: System.Messaging\n  summary: Rolls back the pending internal transaction.\n  remarks: \"Abort marks the unsuccessful completion of a process begun at a call to <xref:System.Messaging.MessageQueueTransaction.Begin%2A>.  \\n  \\n Typically, one makes a call to <xref:System.Messaging.MessageQueueTransaction.Begin%2A> within a `Try...Catch` exception-handling block, putting a call to <xref:System.Messaging.MessageQueueTransaction.Commit%2A> in the `Try` clause, and a call to Abort in the `Catch` clause.  \\n  \\n Abort rolls back the entire transaction. This includes all messages sent or received after the call to <xref:System.Messaging.MessageQueueTransaction.Begin%2A>.\"\n  syntax:\n    content: public void Abort ();\n    parameters: []\n  overload: System.Messaging.MessageQueueTransaction.Abort*\n  exceptions:\n  - type: System.InvalidOperationException\n    commentId: T:System.InvalidOperationException\n    description: The internal transaction you are attempting to roll back has not started.\n  - type: System.Messaging.MessageQueueException\n    commentId: T:System.Messaging.MessageQueueException\n    description: An internal Message Queuing error occurs.\n  platform:\n  - net462\n- uid: System.Messaging.MessageQueueTransaction.Begin\n  id: Begin\n  parent: System.Messaging.MessageQueueTransaction\n  langs:\n  - csharp\n  name: Begin()\n  nameWithType: MessageQueueTransaction.Begin()\n  fullName: System.Messaging.MessageQueueTransaction.Begin()\n  type: Method\n  assemblies:\n  - System.Messaging\n  namespace: System.Messaging\n  summary: Begins a new Message Queuing internal transaction.\n  remarks: \"Begin marks the start of processing that will be committed or rolled back, depending on the success of the transaction. If an exception occurs during processing, the entire transaction is rolled back. This includes all messages sent or received after the call to Begin.  \\n  \\n Typically, one makes a call to Begin within a `Try...Catch` exception-handling block, putting a call to <xref:System.Messaging.MessageQueueTransaction.Commit%2A> in the `Try` clause, and a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A> in the `Catch` clause.\"\n  syntax:\n    content: public void Begin ();\n    parameters: []\n  overload: System.Messaging.MessageQueueTransaction.Begin*\n  exceptions:\n  - type: System.InvalidOperationException\n    commentId: T:System.InvalidOperationException\n    description: The transaction has already been started.\n  - type: System.Messaging.MessageQueueException\n    commentId: T:System.Messaging.MessageQueueException\n    description: An internal Message Queuing error occurs.\n  platform:\n  - net462\n- uid: System.Messaging.MessageQueueTransaction.Commit\n  id: Commit\n  parent: System.Messaging.MessageQueueTransaction\n  langs:\n  - csharp\n  name: Commit()\n  nameWithType: MessageQueueTransaction.Commit()\n  fullName: System.Messaging.MessageQueueTransaction.Commit()\n  type: Method\n  assemblies:\n  - System.Messaging\n  namespace: System.Messaging\n  summary: Commits a pending internal transaction.\n  remarks: \"Commit marks the successful completion of processing begun at a call to <xref:System.Messaging.MessageQueueTransaction.Begin%2A>. If an exception occurs between the call the <xref:System.Messaging.MessageQueueTransaction.Begin%2A> and the call to Commit, the entire transaction is rolled back. This includes all messages sent or received after the call to <xref:System.Messaging.MessageQueueTransaction.Begin%2A>.  \\n  \\n Typically, one makes a call to <xref:System.Messaging.MessageQueueTransaction.Begin%2A> within a `Try...Catch` exception-handling block, putting a call to Commit in the `Try` clause, and a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A> in the `Catch` clause.\"\n  syntax:\n    content: public void Commit ();\n    parameters: []\n  overload: System.Messaging.MessageQueueTransaction.Commit*\n  exceptions:\n  - type: System.InvalidOperationException\n    commentId: T:System.InvalidOperationException\n    description: The transaction you are trying to commit has not started.\n  - type: System.Messaging.MessageQueueException\n    commentId: T:System.Messaging.MessageQueueException\n    description: An internal Message Queuing error occurs.\n  platform:\n  - net462\n- uid: System.Messaging.MessageQueueTransaction.Dispose\n  id: Dispose\n  parent: System.Messaging.MessageQueueTransaction\n  langs:\n  - csharp\n  name: Dispose()\n  nameWithType: MessageQueueTransaction.Dispose()\n  fullName: System.Messaging.MessageQueueTransaction.Dispose()\n  type: Method\n  assemblies:\n  - System.Messaging\n  namespace: System.Messaging\n  summary: Releases all resources used by the <xref href=\"System.Messaging.MessageQueueTransaction\"></xref>.\n  remarks: \"Calling Dispose allows the resources used by the <xref:System.Messaging.MessageQueueTransaction> to be reallocated for other purposes. For more information about `Dispose`, see [Cleaning Up Unmanaged Resources](~/add/includes/ajax-current-ext-md.md).  \\n  \\n Any pending internal transactions are rolled back by Dispose.\"\n  syntax:\n    content: public void Dispose ();\n    parameters: []\n  overload: System.Messaging.MessageQueueTransaction.Dispose*\n  exceptions: []\n  platform:\n  - net462\n- uid: System.Messaging.MessageQueueTransaction.Dispose(System.Boolean)\n  id: Dispose(System.Boolean)\n  parent: System.Messaging.MessageQueueTransaction\n  langs:\n  - csharp\n  name: Dispose(Boolean)\n  nameWithType: MessageQueueTransaction.Dispose(Boolean)\n  fullName: System.Messaging.MessageQueueTransaction.Dispose(Boolean)\n  type: Method\n  assemblies:\n  - System.Messaging\n  namespace: System.Messaging\n  summary: Releases the unmanaged resources used by the <xref href=\"System.Messaging.MessageQueueTransaction\"></xref> and optionally releases the managed resources.\n  remarks: \"This method is called by the public <xref:System.Messaging.MessageQueueTransaction.Dispose%2A> method and the <xref:System.Object.Finalize%2A> method. `Dispose` invokes the protected `Dispose(Boolean)` method with the `disposing` parameter set to `true`. <xref:System.Object.Finalize%2A> invokes `Dispose` with `disposing` set to `false`.  \\n  \\n When the `disposing` parameter is `true`, this method releases all resources held by any managed objects that this <xref:System.Messaging.MessageQueueTransaction> references. This method invokes the `Dispose` method of each referenced object.\"\n  syntax:\n    content: protected virtual void Dispose (bool disposing);\n    parameters:\n    - id: disposing\n      type: System.Boolean\n      description: <xref uid=\"langword_csharp_true\" name=\"true\" href=\"\"></xref> to release both managed and unmanaged resources; <xref uid=\"langword_csharp_false\" name=\"false\" href=\"\"></xref> to release only unmanaged resources.\n  overload: System.Messaging.MessageQueueTransaction.Dispose*\n  exceptions: []\n  platform:\n  - net462\n- uid: System.Messaging.MessageQueueTransaction.Finalize\n  id: Finalize\n  parent: System.Messaging.MessageQueueTransaction\n  langs:\n  - csharp\n  name: Finalize()\n  nameWithType: MessageQueueTransaction.Finalize()\n  fullName: System.Messaging.MessageQueueTransaction.Finalize()\n  type: Method\n  assemblies:\n  - System.Messaging\n  namespace: System.Messaging\n  summary: Releases the resources held by the current instance.\n  remarks: \"This method overrides <xref:System.Object.Finalize%2A?displayProperty=fullName>. Application code should not call this method; an object's Finalize method is automatically invoked during garbage collection, unless finalization by the garbage collector has been disabled by a call to the <xref:System.GC.SuppressFinalize%2A?displayProperty=fullName> method.  \\n  \\n For more information, see [Finalize Methods and Destructors](http://msdn.microsoft.com/en-us/fd376774-1643-499b-869e-9546a3aeea70), [Cleaning Up Unmanaged Resources](~/add/includes/ajax-current-ext-md.md), and [Overriding the Finalize Method](http://msdn.microsoft.com/en-us/8026cb68-fe93-43fc-96c1-c09ad7d64cd3).\"\n  syntax:\n    content: ~MessageQueueTransaction ();\n    parameters: []\n  overload: System.Messaging.MessageQueueTransaction.Finalize*\n  exceptions: []\n  platform:\n  - net462\n- uid: System.Messaging.MessageQueueTransaction.Status\n  id: Status\n  parent: System.Messaging.MessageQueueTransaction\n  langs:\n  - csharp\n  name: Status\n  nameWithType: MessageQueueTransaction.Status\n  fullName: System.Messaging.MessageQueueTransaction.Status\n  type: Property\n  assemblies:\n  - System.Messaging\n  namespace: System.Messaging\n  summary: Gets the status of the transaction.\n  remarks: When an instance of the <xref:System.Messaging.MessageQueueTransaction> class has been created, the Status is set by the constructor to `Initialized`. After a call to <xref:System.Messaging.MessageQueueTransaction.Begin%2A> but before a call to <xref:System.Messaging.MessageQueueTransaction.Commit%2A> or <xref:System.Messaging.MessageQueueTransaction.Abort%2A>, the Status is `Pending`.\n  syntax:\n    content: public System.Messaging.MessageQueueTransactionStatus Status { get; }\n    return:\n      type: System.Messaging.MessageQueueTransactionStatus\n      description: One of the <xref href=\"System.Messaging.MessageQueueTransactionStatus\"></xref> values that indicates whether the transaction has been committed, aborted, initialized, or is pending.\n  overload: System.Messaging.MessageQueueTransaction.Status*\n  exceptions: []\n  platform:\n  - net462\nreferences:\n- uid: System.Object\n  isExternal: false\n  name: System.Object\n- uid: System.InvalidOperationException\n  isExternal: true\n  name: System.InvalidOperationException\n- uid: System.Messaging.MessageQueueException\n  parent: System.Messaging\n  isExternal: false\n  name: MessageQueueException\n  nameWithType: MessageQueueException\n  fullName: System.Messaging.MessageQueueException\n- uid: System.Messaging.MessageQueueTransaction.#ctor\n  parent: System.Messaging.MessageQueueTransaction\n  isExternal: false\n  name: MessageQueueTransaction()\n  nameWithType: MessageQueueTransaction.MessageQueueTransaction()\n  fullName: System.Messaging.MessageQueueTransaction.MessageQueueTransaction()\n- uid: System.Messaging.MessageQueueTransaction.Abort\n  parent: System.Messaging.MessageQueueTransaction\n  isExternal: false\n  name: Abort()\n  nameWithType: MessageQueueTransaction.Abort()\n  fullName: System.Messaging.MessageQueueTransaction.Abort()\n- uid: System.Messaging.MessageQueueTransaction.Begin\n  parent: System.Messaging.MessageQueueTransaction\n  isExternal: false\n  name: Begin()\n  nameWithType: MessageQueueTransaction.Begin()\n  fullName: System.Messaging.MessageQueueTransaction.Begin()\n- uid: System.Messaging.MessageQueueTransaction.Commit\n  parent: System.Messaging.MessageQueueTransaction\n  isExternal: false\n  name: Commit()\n  nameWithType: MessageQueueTransaction.Commit()\n  fullName: System.Messaging.MessageQueueTransaction.Commit()\n- uid: System.Messaging.MessageQueueTransaction.Dispose\n  parent: System.Messaging.MessageQueueTransaction\n  isExternal: false\n  name: Dispose()\n  nameWithType: MessageQueueTransaction.Dispose()\n  fullName: System.Messaging.MessageQueueTransaction.Dispose()\n- uid: System.Messaging.MessageQueueTransaction.Dispose(System.Boolean)\n  parent: System.Messaging.MessageQueueTransaction\n  isExternal: false\n  name: Dispose(Boolean)\n  nameWithType: MessageQueueTransaction.Dispose(Boolean)\n  fullName: System.Messaging.MessageQueueTransaction.Dispose(Boolean)\n- uid: System.Boolean\n  parent: System\n  isExternal: true\n  name: Boolean\n  nameWithType: Boolean\n  fullName: System.Boolean\n- uid: System.Messaging.MessageQueueTransaction.Finalize\n  parent: System.Messaging.MessageQueueTransaction\n  isExternal: false\n  name: Finalize()\n  nameWithType: MessageQueueTransaction.Finalize()\n  fullName: System.Messaging.MessageQueueTransaction.Finalize()\n- uid: System.Messaging.MessageQueueTransaction.Status\n  parent: System.Messaging.MessageQueueTransaction\n  isExternal: false\n  name: Status\n  nameWithType: MessageQueueTransaction.Status\n  fullName: System.Messaging.MessageQueueTransaction.Status\n- uid: System.Messaging.MessageQueueTransactionStatus\n  parent: System.Messaging\n  isExternal: false\n  name: MessageQueueTransactionStatus\n  nameWithType: MessageQueueTransactionStatus\n  fullName: System.Messaging.MessageQueueTransactionStatus\n- uid: System.Messaging.MessageQueueTransaction.#ctor*\n  parent: System.Messaging.MessageQueueTransaction\n  isExternal: false\n  name: MessageQueueTransaction\n  nameWithType: MessageQueueTransaction.MessageQueueTransaction\n- uid: System.Messaging.MessageQueueTransaction.Abort*\n  parent: System.Messaging.MessageQueueTransaction\n  isExternal: false\n  name: Abort\n  nameWithType: MessageQueueTransaction.Abort\n- uid: System.Messaging.MessageQueueTransaction.Begin*\n  parent: System.Messaging.MessageQueueTransaction\n  isExternal: false\n  name: Begin\n  nameWithType: MessageQueueTransaction.Begin\n- uid: System.Messaging.MessageQueueTransaction.Commit*\n  parent: System.Messaging.MessageQueueTransaction\n  isExternal: false\n  name: Commit\n  nameWithType: MessageQueueTransaction.Commit\n- uid: System.Messaging.MessageQueueTransaction.Dispose*\n  parent: System.Messaging.MessageQueueTransaction\n  isExternal: false\n  name: Dispose\n  nameWithType: MessageQueueTransaction.Dispose\n- uid: System.Messaging.MessageQueueTransaction.Finalize*\n  parent: System.Messaging.MessageQueueTransaction\n  isExternal: false\n  name: Finalize\n  nameWithType: MessageQueueTransaction.Finalize\n- uid: System.Messaging.MessageQueueTransaction.Status*\n  parent: System.Messaging.MessageQueueTransaction\n  isExternal: false\n  name: Status\n  nameWithType: MessageQueueTransaction.Status\n"}